/*! License information can be found in https://raw.githubusercontent.com/markeaze/markeaze-js-chat-client/master/dist/mkz-chat-client.js.LICENSE */
!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e.exports=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}},function(e,t,n){var i=n(14),r=n(15),o=n(16),s=n(18);e.exports=function(e,t){return i(e)||r(e,t)||o(e,t)||s()}},function(e,t,n){var i=n(4);e.exports={name:"mkz_c_msg_history",cached:!1,history:[],getHistory:function(){if(this.cached&&i.cached)return this.history;this.cached=!0;var e=localStorage.getItem(this.name),t=[];try{t=JSON.parse(e)||[]}catch(e){}return this.history=this.sortHistory(t.concat(i.getHistory())),this.history},saveHistory:function(e){return this.cached=!1,localStorage.setItem(this.name,JSON.stringify(e.filter((function(e){return!e.exclude})))),e},addMsg:function(e){var t=this.getHistory(),n=this.findMsgIndex(e.muid),i={muid:e.muid,msg_type:e.msg_type,text:e.text,custom_fields:e.custom_fields,agent_id:e.agent_id,sender_type:e.sender_type,sent_at:e.sent_at,sender_avatar_url:e.sender_avatar_url,sender_name:e.sender_name,attachments:e.attachments,exclude:e.exclude};-1===n?t.push(i):t[n]=i,this.saveHistory(t)},getNextMsg:function(e){var t=this.findMsgIndex(e),n=this.getHistory();if(n[t+1])return n[t+1]},batchUpdateMsg:function(e,t){var n=this.getHistory(),i=n.filter(e);return i.map(t),this.saveHistory(n),i},findMsgIndex:function(e){return this.getHistory().findIndex((function(t){return t.muid===e}))},findMsg:function(e){return this.getHistory().find((function(t){return t.muid===e}))},sortHistory:function(e){for(var t=1,n=e.length;t<n;t++){for(var i=e[t],r=t;r>0&&new Date(e[r-1].sent_at)>new Date(i.sent_at);)e[r]=e[r-1],r--;e[r]=i}return e}}},function(e,t,n){function i(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,s=!0,a=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw o}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var o=n(12);e.exports={cached:!1,init:function(e){var t=this;this.app=e,this.libs=e.libs,this.cached=!1,this.items=o.getItems(),this.rendered=!1,this.libs.eEmit.subscribe("plugin.chat.auto_messages",this.saveItems.bind(this)),this.libs.eEmit.subscribe("plugin.chat.channel.entered",(function(){t.rendered=!0,t.renderNewItems()}))},getHistory:function(){return this.cached=!0,this.items.map((function(e){return e.payload}))},saveItems:function(e){var t=this;if(0!==e.length){this.cached=!1;var n=this.app.store.uid;this.items=o.addItems(e.map((function(e){var i=t.app.getDateTime(),r=+new Date(i);return{payload:{auto_message_uid:e.uid,agent_id:e.sender_id,attachments:[],muid:"".concat(n,":a:").concat(r),msg_type:"message:auto",sender_type:e.sender_type,sender_avatar_url:null,sender_name:null,sent_at:i,text:e.text,exclude:!0,custom_fields:e},state:"new",sent_at:i}}))),this.rendered&&this.renderNewItems()}},renderNewItems:function(){var e=this.items.filter((function(e){return"new"===e.state}));if(0!==e.length){this.cached=!1;var t,n=i(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,s=r.payload;this.app.addMsg(s),s.agent_id&&this.app.setCurrentAgent(s.agent_id),this.trackShow(s.custom_fields.uid),r.state="sent"}}catch(e){n.e(e)}finally{n.f()}this.app.view.showChat(),o.setItems(this.items)}},removeItem:function(e){this.cached=!1,this.items=o.removeItem(e)},trackShow:function(e){mkz("trackAutoMessageShow",{auto_message_uid:e})},trackReply:function(e){var t=this.items.find((function(t){return t.payload.muid===e}));if(t){var n=t.payload.custom_fields;mkz("trackAutoMessageReply",{auto_message_uid:n.uid,reply_text:n.text,reply_once:n.reply_once})}}}},function(e,t){e.exports={name:"mkz_c_delivered",addItem:function(e){var t=this.getList();return t.push(e),this.setList(t),t},getList:function(){var e=localStorage.getItem(this.name),t=[];try{t=JSON.parse(e)||[]}catch(e){}return t},setList:function(e){return localStorage.setItem(this.name,JSON.stringify(e)),e},resetList:function(){this.setList([])}}},function(e,t){e.exports="[mkz]{line-height:1}[mkz] html,[mkz] body,[mkz] div,[mkz] span,[mkz] applet,[mkz] object,[mkz] iframe,[mkz] h1,[mkz] h2,[mkz] h3,[mkz] h4,[mkz] h5,[mkz] h6,[mkz] p,[mkz] blockquote,[mkz] pre,[mkz] a,[mkz] abbr,[mkz] acronym,[mkz] address,[mkz] big,[mkz] cite,[mkz] code,[mkz] del,[mkz] dfn,[mkz] em,[mkz] img,[mkz] ins,[mkz] kbd,[mkz] q,[mkz] s,[mkz] samp,[mkz] small,[mkz] strike,[mkz] strong,[mkz] sub,[mkz] sup,[mkz] tt,[mkz] var,[mkz] b,[mkz] u,[mkz] i,[mkz] center,[mkz] dl,[mkz] dt,[mkz] dd,[mkz] ol,[mkz] ul,[mkz] li,[mkz] fieldset,[mkz] form,[mkz] label,[mkz] legend,[mkz] table,[mkz] caption,[mkz] tbody,[mkz] tfoot,[mkz] thead,[mkz] tr,[mkz] th,[mkz] td,[mkz] article,[mkz] aside,[mkz] canvas,[mkz] details,[mkz] embed,[mkz] figure,[mkz] figcaption,[mkz] footer,[mkz] header,[mkz] hgroup,[mkz] menu,[mkz] nav,[mkz] output,[mkz] ruby,[mkz] section,[mkz] summary,[mkz] time,[mkz] mark,[mkz] audio,[mkz] video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;color:inherit;font-weight:inherit;text-transform:inherit;max-width:none}[mkz] label,[mkz] legend{width:auto;height:auto}[mkz] input,[mkz] select,[mkz] textarea,[mkz] button{margin:0;padding:0;font-size:100%;font:inherit;vertical-align:baseline;background-image:none;outline:none}[mkz] article,[mkz] aside,[mkz] details,[mkz] figcaption,[mkz] figure,[mkz] footer,[mkz] header,[mkz] hgroup,[mkz] menu,[mkz] nav,[mkz] section{display:block}[mkz] ol,[mkz] ul{list-style:none}[mkz] blockquote,[mkz] q{quotes:none}[mkz] blockquote:before,[mkz] blockquote:after,[mkz] q:before,[mkz] q:after{content:'';content:none}[mkz] table{border-collapse:collapse;border-spacing:0}[mkz] .mkz-c{text-align:left;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;font-size:15px;color:#333;display:none}[mkz] .mkz-c *{font-family:Geneva,Arial,Helvetica,sans-serif;-webkit-tap-highlight-color:transparent}[mkz] .mkz-c_display_yes{display:block}[mkz] .mkz-c_chat_show .mkz-c__chat{opacity:1;visibility:visible}[mkz] .mkz-c_beacon_show .mkz-c__handler{opacity:1;visibility:visible}[mkz] .mkz-c_beacon_show .mkz-c__btn{animation-play-state:paused}[mkz] .mkz-c_beacon_show.mkz-c_tooltip_yes .mkz-c__tooltip{opacity:1;visibility:visible}[mkz] .mkz-c_agent_assign .mkz-c__m-unassign-text{display:none}[mkz] .mkz-c_agent_assign .mkz-c__m-assign-text,[mkz] .mkz-c_agent_assign .mkz-c__m-assign-post,[mkz] .mkz-c_agent_assign .mkz-c__m-assign-avatar{display:block}[mkz] .mkz-c_agent_online .mkz-c__state{background-color:#0EC52C}[mkz] .mkz-c_agent_online .mkz-c__btn-text-online{display:block}[mkz] .mkz-c_agent_online .mkz-c__btn-text-offline{display:none}[mkz] .mkz-c__handler{transition:opacity 0.2s linear, visibility 0.4s 0s linear;opacity:0;visibility:hidden;position:fixed;z-index:20000000}[mkz] .mkz-c__handler_position_l-t{left:0;top:0}[mkz] .mkz-c__handler_position_r-t{right:0;top:0}[mkz] .mkz-c__handler_position_l-b{left:0;bottom:0}[mkz] .mkz-c__handler_position_r-b{right:0;bottom:0}[mkz] .mkz-c__handler_type_bubble.mkz-c__handler_bouncing_yes .mkz-c__btn{animation:mkzBounceMdScale  5s infinite linear}[mkz] .mkz-c__handler_type_bubble.mkz-c__handler_position_l-t .mkz-c__tooltip,[mkz] .mkz-c__handler_type_bubble.mkz-c__handler_position_l-b .mkz-c__tooltip{left:100%;right:auto;margin-left:15px;margin-right:0;border-radius:0 6px 6px 0}[mkz] .mkz-c__handler_type_bubble.mkz-c__handler_position_l-t .mkz-c__tooltip:after,[mkz] .mkz-c__handler_type_bubble.mkz-c__handler_position_l-b .mkz-c__tooltip:after{left:-10px;right:auto;transform:rotate(180deg)}[mkz] .mkz-c__handler_type_bubble.mkz-c__handler_position_l-t .mkz-c__tooltip:before,[mkz] .mkz-c__handler_type_bubble.mkz-c__handler_position_l-b .mkz-c__tooltip:before{left:-1px;right:auto}[mkz] .mkz-c__handler_type_bubble.mkz-c__handler_position_l-t .mkz-c__tooltip_picture_yes,[mkz] .mkz-c__handler_type_bubble.mkz-c__handler_position_l-b .mkz-c__tooltip_picture_yes{padding-left:5px;padding-right:40px}[mkz] .mkz-c__handler_type_bubble.mkz-c__handler_position_l-t .mkz-c__tooltip-picture,[mkz] .mkz-c__handler_type_bubble.mkz-c__handler_position_l-b .mkz-c__tooltip-picture{position:absolute;left:auto;right:-35px}[mkz] .mkz-c__handler_type_bubble .mkz-c__btn{width:60px;height:60px;border-radius:50%;background-color:#eee;color:#000;display:flex;align-items:center;justify-content:center;transition:transform 0.2s linear;box-shadow:0 0 10px rgba(25,25,29,0.25)}[mkz] .mkz-c__handler_type_bubble .mkz-c__btn:hover{transform:scale(1.1);animation-play-state:paused}[mkz] .mkz-c__handler_type_bubble .mkz-c__btn-text{display:none}[mkz] .mkz-c__handler_type_bubble .mkz-c__tooltip{position:absolute;right:100%;top:50%;margin-right:15px;transform:translateY(-50%);box-shadow:0 0 10px rgba(25,25,29,0.25);color:#fff;background:#4F4F4F;padding:5px;border-radius:6px 0 0 6px;width:160px;box-sizing:border-box}[mkz] .mkz-c__handler_type_bubble .mkz-c__tooltip:after{content:'';position:absolute;right:-10px;top:0;bottom:0;width:10px;clip-path:polygon(0 0, 0 0, 100% 50%, 0 100%);background:inherit;box-shadow:0 0 10px rgba(25,25,29,0.25)}[mkz] .mkz-c__handler_type_bubble .mkz-c__tooltip:before{content:'';position:absolute;right:-1px;top:1px;bottom:1px;width:2px;background:inherit}[mkz] .mkz-c__handler_type_bubble .mkz-c__tooltip_picture_yes{padding-left:40px}[mkz] .mkz-c__handler_type_bubble .mkz-c__tooltip-text{font-size:12px;line-height:16px;text-align:center;max-width:100%;overflow:hidden;text-overflow:ellipsis}[mkz] .mkz-c__handler_type_bubble .mkz-c__tooltip-picture{position:absolute;left:-35px;top:50%;transform:translateY(-50%);max-width:79px}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_bouncing_yes .mkz-c__btn{animation:mkzBounceSmScale  5s infinite linear}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_l-t{margin-top:0 !important}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_r-t{margin-top:0 !important}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_l-b{margin-bottom:0 !important}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_r-b{margin-bottom:0 !important}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_l-t .mkz-c__btn,[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_r-t .mkz-c__btn{border-radius:0 0 15px 15px}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_l-t .mkz-c__btn:hover,[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_r-t .mkz-c__btn:hover{padding-top:20px;padding-bottom:8px}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_l-t .mkz-c__tooltip,[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_r-t .mkz-c__tooltip{bottom:auto;top:100%;margin-top:25px;margin-bottom:0;border-radius:0 0 6px 6px}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_l-t .mkz-c__tooltip:after,[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_r-t .mkz-c__tooltip:after{content:'';position:absolute;left:0;right:0;bottom:100%;top:auto;transform:rotate(180deg)}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_t .mkz-c__btn,[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_l .mkz-c__btn{border-radius:0 0 15px 15px}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_t .mkz-c__btn:hover,[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_l .mkz-c__btn:hover{padding-top:20px;padding-bottom:8px}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_t .mkz-c__tooltip,[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_l .mkz-c__tooltip{bottom:auto;top:100%;margin-top:25px;margin-bottom:0;border-radius:0 0 6px 6px}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_t .mkz-c__tooltip:after,[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_l .mkz-c__tooltip:after{content:'';position:absolute;left:0;right:0;bottom:100%;top:auto;transform:rotate(180deg)}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_t{right:0;top:0;margin-top:0 !important}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_l{transform:rotate(-90deg) translateX(-100%);transform-origin:0 0;left:0;top:0;margin-left:0 !important}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_r{transform:rotate(-90deg) translateY(-100%);transform-origin:100% 0;right:0;top:0;margin-right:0 !important}[mkz] .mkz-c__handler_type_bar.mkz-c__handler_position_b{right:0;bottom:0;margin-bottom:0 !important}[mkz] .mkz-c__handler_type_bar .mkz-c__tooltip-picture{display:none}[mkz] .mkz-c__handler_type_bar .mkz-c__btn{display:flex;align-items:center;padding:8px 20px;border-radius:15px 15px 0 0;transition:padding 0.2s ease-out}[mkz] .mkz-c__handler_type_bar .mkz-c__btn:hover{padding-bottom:20px;animation-play-state:paused}[mkz] .mkz-c__handler_type_bar .mkz-c__btn-text{flex:1;font-size:14px;line-height:18px;font-weight:600;max-width:230px;min-height:18px}[mkz] .mkz-c__handler_type_bar .mkz-c__btn-text-online,[mkz] .mkz-c__handler_type_bar .mkz-c__btn-text-offline{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[mkz] .mkz-c__handler_type_bar .mkz-c__btn-picture{flex:0 0 14px;height:14px;margin-left:5px}[mkz] .mkz-c__handler_type_bar .mkz-c__tooltip{position:absolute;bottom:100%;right:0;margin-bottom:25px;box-shadow:0 0 10px rgba(25,25,29,0.25);color:#fff;background:#7261FF;padding:30px 5px;border-radius:6px 6px 0 0;min-width:47px;max-width:80px;box-sizing:border-box;font-weight:600;font-size:16px;line-height:18px;text-align:center}[mkz] .mkz-c__handler_type_bar .mkz-c__tooltip:after{content:'';position:absolute;left:0;right:0;top:100%;height:20px;clip-path:polygon(0 0, 50% 100%, 100% 0, 0 0);background:inherit;box-shadow:0 0 10px rgba(25,25,29,0.25);margin:-1px 0}[mkz] .mkz-c__handler_type_bar .mkz-c__tooltip .mkz-c__tooltip-text{overflow:hidden;text-overflow:ellipsis}[mkz] .mkz-c__btn-text-online{display:none}[mkz] .mkz-c__btn-text-offline{display:block}[mkz] .mkz-c__tooltip{opacity:0;visibility:hidden;transition:opacity 0.2s linear, visibility 0.4s 0s linear}[mkz] .mkz-c__submit{cursor:pointer;transition:all linear 0.2s;opacity:1;color:#787878}[mkz] .mkz-c__submit_disabled_yes{cursor:default;opacity:0.5}[mkz] .mkz-c__chat{transition:opacity 0.2s linear, visibility 0.4s 0s linear;opacity:0;visibility:hidden;position:fixed;right:0;bottom:0;width:100%;max-width:375px;max-height:680px;height:100vh;z-index:20000000}[mkz] .mkz-c__chat_position_left{left:0;right:auto}[mkz] .mkz-c__chat_position_left .mkz-c__cart,[mkz] .mkz-c__chat_position_left .mkz-c__cart-shadow{right:0;left:25px}[mkz] .mkz-c__cart,[mkz] .mkz-c__cart-shadow{position:absolute;left:0;top:25px;right:25px;bottom:25px;display:flex;justify-content:stretch;flex-direction:column;border-radius:6px;z-index:5}[mkz] .mkz-c__cart-shadow{z-index:0;box-shadow:0 0 10px rgba(25,25,29,0.25);opacity:0.75}[mkz] .mkz-c__head,[mkz] .mkz-c__scroll,[mkz] .mkz-c__docs,[mkz] .mkz-c__footer{padding:0 15px}[mkz] .mkz-c__head,[mkz] .mkz-c__docs,[mkz] .mkz-c__footer{flex:0}[mkz] .mkz-c__content,[mkz] .mkz-c__docs{background-color:#fff}[mkz] .mkz-c__content{flex:1;position:relative}[mkz] .mkz-c__scroll{overflow:hidden;overflow-y:auto;position:absolute;left:0;top:0;right:0;bottom:0}[mkz] .mkz-c__head{display:flex;align-items:center;border-bottom:1px solid #E0E0E0;padding-top:5px;padding-bottom:5px;border-radius:6px 6px 0 0;min-height:80px;box-sizing:border-box}[mkz] .mkz-c__head-state{flex:0;padding-right:12px}[mkz] .mkz-c__head-m{flex:1}[mkz] .mkz-c__head-action{flex:0;padding-left:12px}[mkz] .mkz-c__copy-wrap{position:absolute;left:0;bottom:0;right:0;text-align:center}[mkz] .mkz-c__copy{display:inline-block;font-size:11px;line-height:24px;color:#787878;text-decoration:none;background-color:#f7f7f7;border-radius:6px 6px 0 0;padding:0 5px}[mkz] .mkz-c__copy:hover{text-decoration:none}[mkz] .mkz-c__m-assign-text,[mkz] .mkz-c__m-unassign-text{font-weight:600;font-size:14px;line-height:1.2em}[mkz] .mkz-c__m-assign-post{font-size:11px;line-height:1.2em}[mkz] .mkz-c__m-assign-text,[mkz] .mkz-c__m-assign-post,[mkz] .mkz-c__m-assign-avatar{display:none}[mkz] .mkz-c__m-assign-avatar{width:40px;height:40px;border-radius:50%}[mkz] .mkz-c__close{cursor:pointer;padding:10px;margin:0 -10px;opacity:0.7;transition:all linear 0.2s}[mkz] .mkz-c__close:hover{opacity:1}[mkz] .mkz-c__state-wrap{position:relative;min-width:10px;min-height:10px}[mkz] .mkz-c__state{position:absolute;right:0;bottom:0;width:10px;height:10px;border-radius:50%;background-color:red;transition:background 0.5s linear;box-shadow:0 0 1px 1px #fff}[mkz] .mkz-c__footer{border-top:1px solid #E0E0E0;display:flex;align-items:center;padding-top:30px;padding-bottom:31px;background-color:#fff;border-radius:0 0 6px 6px}[mkz] .mkz-c__footer-msg{flex:1}[mkz] .mkz-c__footer-btn{flex:0;display:none}[mkz] .mkz-c__input{display:block;width:100%;resize:none;padding:0;font-size:13px;line-height:1.2em;font-family:Geneva,Arial,Helvetica,sans-serif;color:#000;border-style:none;outline-style:none;background-color:transparent;overflow:hidden;max-height:50vh;min-height:18px;height:0;-webkit-appearance:none}[mkz] .mkz-c__btn{color:#7261FF;cursor:pointer}[mkz] .mkz-c__btn-unread{background-color:red;width:16px;height:16px;font-size:8px;line-height:16px;text-align:center;color:#fff;overflow:hidden;position:absolute;right:-5px;top:-5px;border-radius:50%;box-shadow:0 0 1px 2px #fff}[mkz] .mkz-c__list{padding:20px 0}[mkz] .mkz-c__i{display:flex;margin:15px 0}[mkz] .mkz-c__i-avatar{display:flex;align-items:flex-end;flex:0 0 24px;padding:5px 0}[mkz] .mkz-c__i_type_client{flex-direction:row-reverse}[mkz] .mkz-c__i_type_client .mkz-c__i-avatar{display:none;background-color:#E7FEEA}[mkz] .mkz-c__i_type_client .mkz-c__i-msg{background-color:#fff;border-radius:6px 6px 0 6px}[mkz] .mkz-c__i-content{max-width:100%;overflow:hidden;padding:5px}[mkz] .mkz-c__i-avatar-img{width:24px;height:24px;border-radius:50%}[mkz] .mkz-c__i-msg{text-align:left;background-color:#E7FEEA;border-radius:6px 6px 6px 0;padding:8px 15px;box-shadow:0px 0px 4px rgba(0,0,0,0.12),0px 0px 1px rgba(0,0,0,0.48);font-size:13px;line-height:1.5em;width:100%;box-sizing:border-box}[mkz] .mkz-c__i-msg:not(:last-child){margin-bottom:15px}[mkz] .mkz-c__i-msg h1{font-size:28px}[mkz] .mkz-c__i-msg h2{font-size:26px}[mkz] .mkz-c__i-msg h3{font-size:22px}[mkz] .mkz-c__i-msg h4{font-size:20px}[mkz] .mkz-c__i-msg h5{font-size:18px}[mkz] .mkz-c__i-msg h6{font-size:16px}[mkz] .mkz-c__i-msg strong{font-weight:bold}[mkz] .mkz-c__i-msg em{font-style:italic}[mkz] .mkz-c__i-msg code{color:#e83e8c}[mkz] .mkz-c__i-msg p{margin:0;padding:0}[mkz] .mkz-c__i-msg a{color:inherit;text-decoration:underline}[mkz] .mkz-c__i-msg a:hover{color:inherit;text-decoration:none}[mkz] .mkz-c__i-msg-overflow,[mkz] .mkz-c__i-msg-overflow p,[mkz] .mkz-c__i-msg-overflow code{overflow:hidden;text-overflow:ellipsis}[mkz] .mkz-c-o__i{width:230px}[mkz] .mkz-c-o__i:not(:last-child){margin-bottom:20px}[mkz] .mkz-c-o__content{padding:20px;border:1px solid #E0E0E0;border-radius:6px}[mkz] .mkz-c-o__preview-link{display:flex;align-items:center;justify-content:center;height:104px;margin-bottom:10px}[mkz] .mkz-c-o__preview-img{display:block;max-width:100%;max-height:100%;color:#787878}[mkz] .mkz-c-o__name{font-size:13px;line-height:18px;margin-bottom:10px}[mkz] .mkz-c-o__name-link{color:#000;text-decoration:none;cursor:pointer}[mkz] .mkz-c-o__name-link:hover{text-decoration:underline}[mkz] .mkz-c-o__info{display:flex;align-items:baseline;margin-bottom:15px}[mkz] .mkz-c-o__info-price,[mkz] .mkz-c-o__info-avaliable{flex:1}[mkz] .mkz-c-o__info-price{font-weight:600;font-size:16px;line-height:1.2em;padding-right:10px}[mkz] .mkz-c-o__info-avaliable{text-align:right;font-size:12px;line-height:1.2em;white-space:nowrap}[mkz] .mkz-c-o__info-avaliable_color_green{color:#37833B}[mkz] .mkz-c-o__info-avaliable_color_red{color:#FC4566}[mkz] .mkz-c-o__btn{font-weight:600;font-size:13px;line-height:1.2em;color:#fff;background-color:#FF6575;border-radius:99px;padding:8px 15px;text-align:center;display:block;outline-style:none;text-decoration:none;cursor:pointer}[mkz] .mkz-c-o__btn[disabled],[mkz] .mkz-c-o__btn[disabled]:hover{background-color:#DF4555;cursor:default}[mkz] .mkz-c-o__btn:hover{text-decoration:none;background-color:#EF5565}[mkz] .mkz-c-o__counter{font-size:10px;line-height:18px;padding:3px 10px;color:#787878}[mkz] .mkz-c-docs{margin:10px -3px;overflow:hidden}[mkz] .mkz-c-docs__list{display:flex}[mkz] .mkz-c-docs__i{flex:1;padding:0 3px;box-sizing:border-box}[mkz] .mkz-c-docs__btn{cursor:pointer;font-size:11px;line-height:1.2em;color:#000;background-color:#F0F0F1;border:1px solid #E0E0E0;border-radius:10px;text-align:center;padding:4px 15px;display:block;width:100%;box-sizing:border-box;white-space:nowrap}[mkz] .mkz-c-docs__btn:hover{background-color:#E0E0E1}[mkz] .mkz-f{width:230px;margin:0;padding:5px 0}[mkz] .mkz-f__row:not(:last-child){margin-bottom:10px}[mkz] .mkz-f__label{display:block;font-size:14px;line-height:1.2em;margin-bottom:4px}[mkz] .mkz-f__input,[mkz] .mkz-f__select{display:block;width:100%;box-sizing:border-box;resize:none;padding:0 0 0 10px;font-size:13px;line-height:30px;height:32px;font-family:Geneva,Arial,Helvetica,sans-serif;color:#000;outline-style:none;background-color:#fff;border-radius:6px;border:1px solid #CBCBCB;overflow:hidden;-webkit-appearance:none}[mkz] .mkz-f__input[disabled],[mkz] .mkz-f__select[disabled]{color:#777;background-color:#eee}[mkz] .mkz-f__select{appearance:none;-moz-appearance:none;-webkit-appearance:none;position:relative;background-image:url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100' height='50' fill='%23000000'><polygon points='0,0 100,0 50,50'/></svg>\");background-repeat:no-repeat;background-position:calc(100% - 10px) center;background-size:10px}[mkz] .mkz-f__note{font-size:9px;line-height:1.2em;text-align:center}[mkz] .mkz-f__btn{display:block;width:100%;box-sizing:border-box;font-weight:600;font-size:13px;line-height:1.2em;color:#fff;background-color:#7261FF;border-radius:6px;border-style:none;padding:8px 15px;text-align:center;outline-style:none;text-decoration:none;cursor:pointer;text-transform:uppercase}[mkz] .mkz-f__btn[disabled],[mkz] .mkz-f__btn[disabled]:hover{background-color:#6251EF;color:#aaa;cursor:default}[mkz] .mkz-f__btn:hover{text-decoration:none;background-color:#6251EF}[mkz] .mkz-f__invalid,[mkz] .mkz-f__invalid::placeholder{color:red !important;box-shadow:0 0 1px 1px red !important}.mkz-c-mobile.mkz-c-fixed{position:fixed !important;height:100% !important;width:100% !important;max-width:100% !important;overflow-x:hidden !important}.mkz-c-mobile.mkz-c-fixed body{z-index:auto !important;zoom:1 !important;max-width:100% !important;overflow-x:hidden !important}.mkz-c-mobile [mkz] .mkz-c__chat{max-height:none;max-width:none;width:auto;height:auto;right:0;left:0;top:0;bottom:0}.mkz-c-mobile [mkz] .mkz-c__cart,.mkz-c-mobile [mkz] .mkz-c__chat_position_left .mkz-c__cart{right:0;left:0;top:0;bottom:0;border-style:none}.mkz-c-mobile [mkz] .mkz-c__cart,.mkz-c-mobile [mkz] .mkz-c__head,.mkz-c-mobile [mkz] .mkz-c__footer{border-radius:0}.mkz-c-mobile [mkz] .mkz-c__footer-btn{display:block}@keyframes mkzBounceMdScale{94%{transform:scale(1)}98%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes mkzBounceSmScale{94%{transform:scale(1)}98%{transform:scale(1.05)}100%{transform:scale(1)}}\n"},function(e,t,n){var i=n(19).markdown;e.exports={removeClass:function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},addClass:function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},appendHTML:function(e,t){var n=document.createElement("div");n.innerHTML=t;var i=this.getFirstChild(n);return e.appendChild(i),i},beforeHTML:function(e,t){var n=document.createElement("div");n.innerHTML=t;var i=this.getFirstChild(n);return e.parentNode.insertBefore(i,e),i},getFirstChild:function(e){for(var t=e.firstChild;null!=t&&3==t.nodeType;)t=t.nextSibling;return t},htmlToText:function(e){var t=document.createElement("div");return t.textContent=e||"",t.innerHTML},srcset:function(e){var t=function(e,t){var n=e.split("/"),i=n.length-1;return n[i]="x".concat(t,"_").concat(n[i]),"".concat(n.join("/")," ").concat(t,"x")};return"".concat(t(e,2),", ").concat(t(e,3))},br:function(e){return(e||"").split("\n").join("<br />")},htmlFormatting:function(e){return e?this.linkify(this.br(i.toHTML(e))):""},textFormatting:function(e){return this.htmlFormatting(this.htmlToText(e))},getUrlParameter:function(e){if(regex=new RegExp("[?&]"+e+"=([^&#]*)"),results=regex.exec(location.search),null!==results)return decodeURIComponent(results[1].replace(/\+/g," "))},linkify:function(e){if(!e)return e;return e=(e=(e=e.replace(/([^"'])(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])([^"']?)/gim,'$1<a href="$2" target="_blank">$2</a>$4')).replace(/([^"']|^|[^\/])(www\.[\S]+(\b|$))([^"']?)/gim,'$1<a href="http://$2" target="_blank">$2</a>$4')).replace(/([^"'])(([a-zA-Z_-]+\.)*[a-zA-Z_-]+@([a-zA-Z_-]+\.)*[a-zA-Z_-]+\.[a-zA-Z]{2,6})([^"']?)/gim,'$1<a href="mailto:$2">$2</a>$5')}}},function(e,t){e.exports={ru:{copyright:"Сделано в Markeaze",placeholder:"Напишите ваше сообщение...",in_stock:"В наличии",out_of_stock:"Не в наличии",view_product:"Посмотреть товар",add_to_cart:"Добавить в корзину",added_to_cart:"Добавлен в корзину",true:"Да",false:"Нет",new_message:"New message..."},en:{copyright:"Powered by Markeaze",placeholder:"Type your message here...",in_stock:"In stock",out_of_stock:"Out of stock",view_product:"View product",add_to_cart:"Add to cart",added_to_cart:"Added to Cart!",true:"True",false:"False",new_message:"Новое сообщение..."}}},function(e,t,n){function i(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,s=!0,a=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw o}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var o=n(11).Socket,s=n(3),a=n(5),l=n(13).default,c=n(4),h=n(28),u=n(29).default;e.exports={version:"1.4.5",airbrakeProject:254408,airbrakeApiKey:"84e2f7b3f257c5fffb9edf2d951f2054",store:{},libs:{},previewMode:!1,isMobile:!1,create:function(e,t){var n=this;this.libs.notifierInstance?this.notifier=this.libs.notifierInstance(this.version,this.airbrakeProject,this.airbrakeApiKey,"production"):this.notifier=this.libs.notifier,this.notifier.call((function(){n.settings=t,n.locale=e,n.log("chat","created"),n.view=new l(n),n.sound=new u(n.settings.appearance.client_sound_path),c.init(n),n.libs.eEmit.subscribe("plugin.chat.show",n.view.showChat.bind(n.view)),n.libs.eEmit.subscribe("plugin.chat.hide",n.view.hideChat.bind(n.view)),n.isMobile=n.libs.helpers.isMobile(),n.createConnection(),n.urlBind()}))},destroy:function(){this.view&&this.view.destroy(),this.socket&&this.socket.disconnect()},preview:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.previewMode=!0,this.isMobile=Boolean(n.isMobile),this.settings=t,this.locale=e,this.view=new l(this),this.view.history=n.history||[],this.view.width=n.width||null,this.view.render(),this.view.visibleChat(),n.collapsed?this.view.showNotice():this.view.showChat(),n.currentAgent&&(this.currentAgent=n.currentAgent,this.view.assignAgent(),this.updateAgentState())},currentAgent:null,agents:[],agentIsOnline:!1,sessionsCount:0,settings:{},locale:null,log:function(){var e;this.libs.log&&(e=this.libs.log).push.apply(e,["chat"].concat(Array.prototype.slice.call(arguments)))},urlBind:function(){decodeURIComponent(window.location.search).indexOf("mkz-chat=open")>-1&&this.view.showChat()},createConnection:function(){var e=this;this.notifier.call((function(){e.view.render(),e.socket=new o("".concat(e.store.chatProtocol||"wss://").concat(e.store.chatEndpoint,"/socket")),e.socket.onOpen(e.handlerConnected.bind(e)),e.socket.onClose(e.handlerDisconnected.bind(e)),e.socket.connect(),e.servicChannel=e.socket.channel("chat-client:".concat(e.store.appKey)),e.servicChannel.join().receive("error",(function(){return e.handlerFailJoined.bind(e,e.servicChannel.topic)})),e.servicChannel.on("agent:entered",e.handlerAgentStatus.bind(e,!0)),e.servicChannel.on("agent:exited",e.handlerAgentStatus.bind(e,!1)),e.clientChannel=e.socket.channel("room:".concat(e.store.appKey,":").concat(e.store.uid)),e.clientChannel.join().receive("ok",e.handlerJoined.bind(e)).receive("error",e.handlerFailJoined.bind(e,e.clientChannel.topic)),e.clientChannel.on("client:entered",e.handlerClientEntered.bind(e)),e.clientChannel.on("message:new",e.handlerMsg.bind(e)),e.clientChannel.on("message:resend",e.handlerMsgResend.bind(e)),e.clientChannel.on("agent:assign",e.handlerAgentAssign.bind(e)),e.clientChannel.on("survey:show",e.handlerSurveyShow.bind(e)),e.clientChannel.on("event:survey_submitted",e.handlerSurveySubmitted.bind(e))}))},handlerConnected:function(){var e=this;this.notifier.call((function(){e.view.connected()}))},handlerDisconnected:function(){var e=this;this.notifier.call((function(){e.view.disconnected()}))},handlerJoined:function(){var e=this;this.notifier.call((function(){e.view.visibleChat(),e.view.scrollBottom(),e.view.enableSending(),e.log("chat","joined")}))},handlerFailJoined:function(e){var t=new Error("Cannot join channel ".concat(e));this.notifier.notify(t)},handlerAgentStatus:function(e,t){var n=this,i=t.agent_id;this.notifier.call((function(){var t=n.getAgent(i);t&&(t.isOnline=e,n.updateAgentState())}))},handlerClientEntered:function(e){var t=this;this.notifier.call((function(){t.setAgents(e.agents),t.sessionsCount=e.sessionsCount,t.setCurrentAgent(e.current_agent_id),t.updateAgentState(),t.libs.eEmit&&t.libs.eEmit.emit("plugin.chat.channel.entered"),t.log("chat","ClientEntered",e)}))},handlerSurveyShow:function(e){var t=this;this.notifier.call((function(){t.view.windowFocus&&h.trackShow(e.custom_fields.uid),t.handlerMsg(e)}))},handlerMsg:function(e){var t=this;this.notifier.call((function(){e=t.addMsg(e),t.stateChangeMsg(e),t.view.scrollBottom(),t.log("chat","Msg",e)}))},handlerMsgResend:function(e){var t=this;this.notifier.call((function(){e=t.addMsg(e),t.stateChangeMsg(e),t.view.scrollBottom(),t.setCurrentAgent(e.current_agent_id),t.log("chat","Resend",e)}))},handlerAgentAssign:function(e){var t=this;this.notifier.call((function(){t.setCurrentAgent(e.target_agent_id)}))},handlerCollapse:function(e){var t=this;this.notifier.call((function(){if(!0!==e){var n,r=a.getList(),o=i(r);try{for(o.s();!(n=o.n()).done;){var s=n.value;t.pusherMsgState(s,"read")}}catch(e){o.e(e)}finally{o.f()}r.length>0&&(a.resetList(),t.view.renderUnread())}}))},handlerSurveySubmitted:function(e){var t=this;this.notifier.call((function(){var n=s.findMsg(e.custom_fields.muid);n&&(n.custom_fields.submitted=!0,s.addMsg(n),t.view.renderMessage(n),s.batchUpdateMsg((function(e){return e.muid!==n.muid&&"survey:show"===e.msg_type&&e.custom_fields.uid===n.custom_fields.uid}),(function(e){return e.custom_fields.hidden=!0})).map((function(e){return t.view.renderMessage(e)})))}))},pusherTyping:function(e){if(e)return this.clientChannel.push("client:activity",{type:"typing",text:e})},pusherNewMsg:function(e){if(e){var t=+new Date,n=this.store.uid,i={muid:"".concat(n,":c:").concat(t),text:e,status:"sent",sent_at:this.getDateTime()},r=s.getHistory(),o=r.length>0&&r[r.length-1];return o&&"message:auto"===o.msg_type&&(i.prev_auto_message={auto_message_uid:o.auto_message_uid,muid:o.muid,agent_id:0,text:o.text,sender_type:"auto",status:"read",sent_at:o.sent_at,device_uid:n},c.trackReply(o.muid)),this.clientChannel.push("message:new",i)}},pusherMsgState:function(e,t){e&&this.clientChannel.push("message:status:change",{muid:e,new_status:t,sent_at:this.getDateTime()})},pusherNewSurveyMsg:function(e,t){var n=s.findMsg(e);n&&(this.clientChannel.push("survey:submit",{muid:e,title:n.custom_fields.title}),h.trackSubmit(n.custom_fields.uid,t))},getDateTime:function(){return(new Date).toISOString().replace("Z","000Z")},stateChangeMsg:function(e){null!==e.agent_id&&(!1===this.view.collapsed?this.pusherMsgState(e.muid,"read"):(this.pusherMsgState(e.muid,"delivered"),a.addItem(e.muid),this.view.renderUnread()))},addMsg:function(e){if(null!==e.agent_id){var t=this.getAgent(e.agent_id);t&&(e.sender_avatar_url=t.avatar_url||t.sender_avatar_url,e.sender_name=t.name||e.sender_name),this.view.windowFocus&&!this.view.collapsed||this.sound.play(),!0===this.view.collapsed&&this.view.showBeacon(!0)}s.addMsg(e);var n=s.getNextMsg(e.muid);return this.view.renderMessage(e,n,!0),e},setCurrentAgent:function(e){if(!e&&!this.currentAgent){var t=Object.values(this.agents).find((function(e){return e.isOnline}));if(!t)return;e=t.id}this.currentAgent=this.getAgent(e),this.currentAgent?this.view.assignAgent():this.view.unassignAgent()},setAgents:function(e){this.agents=e.reduce((function(e,t){return e[t.id]=t,e}),{})},getAgent:function(e){return this.agents[e]||null},updateAgentState:function(){this.currentAgent?this.agentIsOnline=this.currentAgent.isOnline:this.agentIsOnline=Object.values(this.agents).find((function(e){return e.isOnline}))&&!0,this.view.renderAgentState()}}},function(e,t,n){"use strict";n.r(t);var i=n(9);mkz("initPlugin","chat",n.n(i).a)},function(e,t,n){"use strict";n.r(t),n.d(t,"Channel",(function(){return C})),n.d(t,"Serializer",(function(){return S})),n.d(t,"Socket",(function(){return E})),n.d(t,"LongPoll",(function(){return T})),n.d(t,"Ajax",(function(){return j})),n.d(t,"Presence",(function(){return A}));const i="undefined"!=typeof self?self:null,r="undefined"!=typeof window?window:null,o=i||r||void 0,s=0,a=1,l=2,c=3,h="closed",u="errored",d="joined",p="joining",m="leaving",f="phx_close",_="phx_error",g="phx_join",k="phx_reply",b="phx_leave",v=[f,_,g,k,b],z="longpoll",y="websocket";let x=e=>{if("function"==typeof e)return e;return function(){return e}};class w{constructor(e,t,n,i){this.channel=e,this.event=t,this.payload=n||function(){return{}},this.receivedResp=null,this.timeout=i,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}resend(e){this.timeout=e,this.reset(),this.send()}send(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}receive(e,t){return this.hasReceived(e)&&t(this.receivedResp.response),this.recHooks.push({status:e,callback:t}),this}reset(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}matchReceive({status:e,response:t,ref:n}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}cancelRefEvent(){this.refEvent&&this.channel.off(this.refEvent)}cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}startTimeout(){this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,e=>{this.cancelRefEvent(),this.cancelTimeout(),this.receivedResp=e,this.matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}trigger(e,t){this.channel.trigger(this.refEvent,{status:e,response:t})}}class C{constructor(e,t,n){this.state=h,this.topic=e,this.params=x(t||{}),this.socket=n,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new w(this,g,this.params,this.timeout),this.pushBuffer=[],this.stateChangeRefs=[],this.rejoinTimer=new M(()=>{this.socket.isConnected()&&this.rejoin()},this.socket.rejoinAfterMs),this.stateChangeRefs.push(this.socket.onError(()=>this.rejoinTimer.reset())),this.stateChangeRefs.push(this.socket.onOpen(()=>{this.rejoinTimer.reset(),this.isErrored()&&this.rejoin()})),this.joinPush.receive("ok",()=>{this.state=d,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this.joinPush.receive("error",()=>{this.state=u,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.hasLogger()&&this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=h,this.socket.remove(this)}),this.onError(e=>{this.socket.hasLogger()&&this.socket.log("channel","error "+this.topic,e),this.isJoining()&&this.joinPush.reset(),this.state=u,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.joinPush.receive("timeout",()=>{this.socket.hasLogger()&&this.socket.log("channel",`timeout ${this.topic} (${this.joinRef()})`,this.joinPush.timeout),new w(this,b,x({}),this.timeout).send(),this.state=u,this.joinPush.reset(),this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.on(k,(e,t)=>{this.trigger(this.replyEventName(t),e)})}join(e=this.timeout){if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=e,this.joinedOnce=!0,this.rejoin(),this.joinPush}onClose(e){this.on(f,e)}onError(e){return this.on(_,t=>e(t))}on(e,t){let n=this.bindingRef++;return this.bindings.push({event:e,ref:n,callback:t}),n}off(e,t){this.bindings=this.bindings.filter(n=>!(n.event===e&&(void 0===t||t===n.ref)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,n=this.timeout){if(!this.joinedOnce)throw new Error(`tried to push '${e}' to '${this.topic}' before joining. Use channel.join() before pushing events`);let i=new w(this,e,(function(){return t}),n);return this.canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}leave(e=this.timeout){this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=m;let t=()=>{this.socket.hasLogger()&&this.socket.log("channel","leave "+this.topic),this.trigger(f,"leave")},n=new w(this,b,x({}),e);return n.receive("ok",()=>t()).receive("timeout",()=>t()),n.send(),this.canPush()||n.trigger("ok",{}),n}onMessage(e,t,n){return t}isLifecycleEvent(e){return v.indexOf(e)>=0}isMember(e,t,n,i){return this.topic===e&&(!i||i===this.joinRef()||!this.isLifecycleEvent(t)||(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:e,event:t,payload:n,joinRef:i}),!1))}joinRef(){return this.joinPush.ref}sendJoin(e){this.state=p,this.joinPush.resend(e)}rejoin(e=this.timeout){this.isLeaving()||this.sendJoin(e)}trigger(e,t,n,i){let r=this.onMessage(e,t,n,i);if(t&&!r)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");for(let t=0;t<this.bindings.length;t++){const o=this.bindings[t];o.event===e&&o.callback(r,n,i||this.joinRef())}}replyEventName(e){return"chan_reply_"+e}isClosed(){return this.state===h}isErrored(){return this.state===u}isJoined(){return this.state===d}isJoining(){return this.state===p}isLeaving(){return this.state===m}}let S={encode(e,t){let n=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(n))},decode(e,t){let[n,i,r,o,s]=JSON.parse(e);return t({join_ref:n,ref:i,topic:r,event:o,payload:s})}};class E{constructor(e,t={}){this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=t.timeout||1e4,this.transport=t.transport||o.WebSocket||T,this.defaultEncoder=S.encode,this.defaultDecoder=S.decode,this.closeWasClean=!1,this.unloaded=!1,this.binaryType=t.binaryType||"arraybuffer",this.transport!==T?(this.encode=t.encode||this.defaultEncoder,this.decode=t.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder),r&&r.addEventListener&&r.addEventListener("beforeunload",e=>{this.conn&&(this.unloaded=!0,this.abnormalClose("unloaded"))}),this.heartbeatIntervalMs=t.heartbeatIntervalMs||3e4,this.rejoinAfterMs=e=>t.rejoinAfterMs?t.rejoinAfterMs(e):[1e3,2e3,5e3][e-1]||1e4,this.reconnectAfterMs=e=>this.unloaded?100:t.reconnectAfterMs?t.reconnectAfterMs(e):[10,50,100,150,200,250,500,1e3,2e3][e-1]||5e3,this.logger=t.logger||null,this.longpollerTimeout=t.longpollerTimeout||2e4,this.params=x(t.params||{}),this.endPoint=`${e}/${y}`,this.vsn=t.vsn||"2.0.0",this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new M(()=>{this.teardown(()=>this.connect())},this.reconnectAfterMs)}protocol(){return location.protocol.match(/^https/)?"wss":"ws"}endPointURL(){let e=j.appendParams(j.appendParams(this.endPoint,this.params()),{vsn:this.vsn});return"/"!==e.charAt(0)?e:"/"===e.charAt(1)?`${this.protocol()}:${e}`:`${this.protocol()}://${location.host}${e}`}disconnect(e,t,n){this.closeWasClean=!0,this.reconnectTimer.reset(),this.teardown(e,t,n)}connect(e){e&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=x(e)),this.conn||(this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=()=>this.onConnOpen(),this.conn.onerror=e=>this.onConnError(e),this.conn.onmessage=e=>this.onConnMessage(e),this.conn.onclose=e=>this.onConnClose(e))}log(e,t,n){this.logger(e,t,n)}hasLogger(){return null!==this.logger}onOpen(e){let t=this.makeRef();return this.stateChangeCallbacks.open.push([t,e]),t}onClose(e){let t=this.makeRef();return this.stateChangeCallbacks.close.push([t,e]),t}onError(e){let t=this.makeRef();return this.stateChangeCallbacks.error.push([t,e]),t}onMessage(e){let t=this.makeRef();return this.stateChangeCallbacks.message.push([t,e]),t}onConnOpen(){this.hasLogger()&&this.log("transport","connected to "+this.endPointURL()),this.unloaded=!1,this.closeWasClean=!1,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach(([,e])=>e())}resetHeartbeat(){this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs))}teardown(e,t,n){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,n||""):this.conn.close(),this.conn=null),e&&e()}onConnClose(e){this.hasLogger()&&this.log("transport","close",e),this.triggerChanError(),clearInterval(this.heartbeatTimer),this.closeWasClean||this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(([,t])=>t(e))}onConnError(e){this.hasLogger()&&this.log("transport",e),this.triggerChanError(),this.stateChangeCallbacks.error.forEach(([,t])=>t(e))}triggerChanError(){this.channels.forEach(e=>{e.isErrored()||e.isLeaving()||e.isClosed()||e.trigger(_)})}connectionState(){switch(this.conn&&this.conn.readyState){case s:return"connecting";case a:return"open";case l:return"closing";default:return"closed"}}isConnected(){return"open"===this.connectionState()}remove(e){this.off(e.stateChangeRefs),this.channels=this.channels.filter(t=>t.joinRef()!==e.joinRef())}off(e){for(let t in this.stateChangeCallbacks)this.stateChangeCallbacks[t]=this.stateChangeCallbacks[t].filter(([t])=>!e.includes(t))}channel(e,t={}){let n=new C(e,t,this);return this.channels.push(n),n}push(e){if(this.hasLogger()){let{topic:t,event:n,payload:i,ref:r,join_ref:o}=e;this.log("push",`${t} ${n} (${o}, ${r})`,i)}this.isConnected()?this.encode(e,e=>this.conn.send(e)):this.sendBuffer.push(()=>this.encode(e,e=>this.conn.send(e)))}makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}sendHeartbeat(){if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void this.abnormalClose("heartbeat timeout");this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef})}}abnormalClose(e){this.closeWasClean=!1,this.conn.close(1e3,e)}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:n,payload:i,ref:r,join_ref:o}=e;r&&r===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.hasLogger()&&this.log("receive",`${i.status||""} ${t} ${n} ${r&&"("+r+")"||""}`,i);for(let e=0;e<this.channels.length;e++){const s=this.channels[e];s.isMember(t,n,i,o)&&s.trigger(n,i,r,o)}for(let t=0;t<this.stateChangeCallbacks.message.length;t++){let[,n]=this.stateChangeCallbacks.message[t];n(e)}})}}class T{constructor(e){this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(e),this.readyState=s,this.poll()}normalizeEndpoint(e){return e.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+y),"$1/"+z)}endpointURL(){return j.appendParams(this.pollEndpoint,{token:this.token})}closeAndRetry(){this.close(),this.readyState=s}ontimeout(){this.onerror("timeout"),this.closeAndRetry()}poll(){this.readyState!==a&&this.readyState!==s||j.request("GET",this.endpointURL(),"application/json",null,this.timeout,this.ontimeout.bind(this),e=>{if(e){var{status:t,token:n,messages:i}=e;this.token=n}else var t=0;switch(t){case 200:i.forEach(e=>this.onmessage({data:e})),this.poll();break;case 204:this.poll();break;case 410:this.readyState=a,this.onopen(),this.poll();break;case 0:case 500:this.onerror(),this.closeAndRetry();break;default:throw new Error("unhandled poll status "+t)}})}send(e){j.request("POST",this.endpointURL(),"application/json",e,this.timeout,this.onerror.bind(this,"timeout"),e=>{e&&200===e.status||(this.onerror(e&&e.status),this.closeAndRetry())})}close(e,t){this.readyState=c,this.onclose()}}class j{static request(e,t,n,i,r,s,a){if(o.XDomainRequest){let n=new XDomainRequest;this.xdomainRequest(n,e,t,i,r,s,a)}else{let l=o.XMLHttpRequest?new o.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");this.xhrRequest(l,e,t,n,i,r,s,a)}}static xdomainRequest(e,t,n,i,r,o,s){e.timeout=r,e.open(t,n),e.onload=()=>{let t=this.parseJSON(e.responseText);s&&s(t)},o&&(e.ontimeout=o),e.onprogress=()=>{},e.send(i)}static xhrRequest(e,t,n,i,r,o,s,a){e.open(t,n,!0),e.timeout=o,e.setRequestHeader("Content-Type",i),e.onerror=()=>{a&&a(null)},e.onreadystatechange=()=>{if(e.readyState===this.states.complete&&a){let t=this.parseJSON(e.responseText);a(t)}},s&&(e.ontimeout=s),e.send(r)}static parseJSON(e){if(!e||""===e)return null;try{return JSON.parse(e)}catch(t){return console&&console.log("failed to parse JSON response",e),null}}static serialize(e,t){let n=[];for(var i in e){if(!e.hasOwnProperty(i))continue;let r=t?`${t}[${i}]`:i,o=e[i];"object"==typeof o?n.push(this.serialize(o,r)):n.push(encodeURIComponent(r)+"="+encodeURIComponent(o))}return n.join("&")}static appendParams(e,t){if(0===Object.keys(t).length)return e;let n=e.match(/\?/)?"&":"?";return`${e}${n}${this.serialize(t)}`}}j.states={complete:4};class A{constructor(e,t={}){let n=t.events||{state:"presence_state",diff:"presence_diff"};this.state={},this.pendingDiffs=[],this.channel=e,this.joinRef=null,this.caller={onJoin:function(){},onLeave:function(){},onSync:function(){}},this.channel.on(n.state,e=>{let{onJoin:t,onLeave:n,onSync:i}=this.caller;this.joinRef=this.channel.joinRef(),this.state=A.syncState(this.state,e,t,n),this.pendingDiffs.forEach(e=>{this.state=A.syncDiff(this.state,e,t,n)}),this.pendingDiffs=[],i()}),this.channel.on(n.diff,e=>{let{onJoin:t,onLeave:n,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=A.syncDiff(this.state,e,t,n),i())})}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}list(e){return A.list(this.state,e)}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel.joinRef()}static syncState(e,t,n,i){let r=this.clone(e),o={},s={};return this.map(r,(e,n)=>{t[e]||(s[e]=n)}),this.map(t,(e,t)=>{let n=r[e];if(n){let i=t.metas.map(e=>e.phx_ref),r=n.metas.map(e=>e.phx_ref),a=t.metas.filter(e=>r.indexOf(e.phx_ref)<0),l=n.metas.filter(e=>i.indexOf(e.phx_ref)<0);a.length>0&&(o[e]=t,o[e].metas=a),l.length>0&&(s[e]=this.clone(n),s[e].metas=l)}else o[e]=t}),this.syncDiff(r,{joins:o,leaves:s},n,i)}static syncDiff(e,{joins:t,leaves:n},i,r){let o=this.clone(e);return i||(i=function(){}),r||(r=function(){}),this.map(t,(e,t)=>{let n=o[e];if(o[e]=t,n){let t=o[e].metas.map(e=>e.phx_ref),i=n.metas.filter(e=>t.indexOf(e.phx_ref)<0);o[e].metas.unshift(...i)}i(e,n,t)}),this.map(n,(e,t)=>{let n=o[e];if(!n)return;let i=t.metas.map(e=>e.phx_ref);n.metas=n.metas.filter(e=>i.indexOf(e.phx_ref)<0),r(e,n,t),0===n.metas.length&&delete o[e]}),o}static list(e,t){return t||(t=function(e,t){return t}),this.map(e,(e,n)=>t(e,n))}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static clone(e){return JSON.parse(JSON.stringify(e))}}class M{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=null,this.tries=0}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}},function(e,t){function n(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,s=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}e.exports={name:"mkz_c_auto_msg_history",addItems:function(e){var t,i=this.getItems(),r=n(e);try{var o=function(){var e=t.value,n=i.findIndex((function(t){return t.payload.custom_fields.uid===e.payload.custom_fields.uid}));-1===n?i.push(e):i[n].payload.custom_fields=e.payload.custom_fields};for(r.s();!(t=r.n()).done;)o()}catch(e){r.e(e)}finally{r.f()}return this.setItems(i),i},getItems:function(){var e=sessionStorage.getItem(this.name),t=[];try{t=JSON.parse(e)||[]}catch(e){}return t},setItems:function(e){return sessionStorage.setItem(this.name,JSON.stringify(e)),e},removeItem:function(e){var t=this.getItems(),n=t.findIndex((function(t){return t.payload.muid===e}));return-1!==n&&(t.splice(n,1),this.setItems(t)),t}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return View}));var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__);function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw r}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var css=__webpack_require__(6),msgDelivered=__webpack_require__(5),helpers=__webpack_require__(7),domEvent=__webpack_require__(25),_require=__webpack_require__(26),startBlink=_require.startBlink,stopBlink=_require.stopBlink,Template=__webpack_require__(27).default,msgStory=__webpack_require__(3),translations=__webpack_require__(8),View=function(){function View(e){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this,View),this.history=null,this.collapsed="true"!==helpers.getUrlParameter("mkz_expand_chat"),this.oldCollapsed=!0,this.windowFocus=!0,this.app=e,this.previewMode=e.previewMode,this.libs=e.libs,this.allowSending=!1,this.typingTimeout=1e3,this.noticeShowTimeout=1e3,this.noticeHideTimeout=1e4,this.width=null,this.template=new Template(this),this.containerBeaconClassName="mkz-c_beacon_show",this.containerChatClassName="mkz-c_chat_show",this.htmlClassName="mkz-c-fixed",this.mobileClassName="mkz-c-mobile",this.defaultAvatar="https://themes.markeaze.com/default/livechat/default_avatar.png",this.validationOptions={invalidClassName:"mkz-f__invalid",invalidParentClassName:"mkz-f__invalid-wrap"}}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default()(View,[{key:"destroy",value:function(){this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},{key:"bind",value:function(){var e=this;domEvent.add(this.elInput,"keyup",this.setMsgHeight.bind(this)),domEvent.add(this.elToggle,"click",this.showChat.bind(this)),domEvent.add(this.elClose,"click",this.hideChat.bind(this)),this.previewMode||(domEvent.add(window,"focus",this.onFocus.bind(this)),domEvent.add(window,"blur",this.onBlur.bind(this)),domEvent.add(window,"resize",this.setZoom.bind(this)),domEvent.add(this.elSubmit,"click",this.sendMsg.bind(this)),domEvent.add(this.elInput,"keydown",(function(t){13!=t.keyCode||t.shiftKey?e.startTyping():(t.preventDefault(),e.sendMsg())})))}},{key:"bindMessage",value:function(e){if(!this.previewMode){var t,n=_createForOfIteratorHelper(e.querySelectorAll(".mkz-c-o-js-action"));try{for(n.s();!(t=n.n()).done;){var i=t.value;domEvent.add(i,"click",this.clickProductAttachment.bind(this))}}catch(e){n.e(e)}finally{n.f()}var r,o=_createForOfIteratorHelper(e.querySelectorAll(".mkz-f-js"));try{for(o.s();!(r=o.n()).done;){var s=r.value;domEvent.add(s,"submit",this.submitSurveyForm.bind(this))}}catch(e){o.e(e)}finally{o.f()}}}},{key:"setZoom",value:function(){if(window.self===window.top){var e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=window.outerWidth||document.documentElement.outerWidth||document.body.outerWidth,n=window.devicePixelRatio||1,i=t/e||n;i<1||(this.elContainer.style.zoom=1/i)}}},{key:"submitSurveyForm",value:function(e){e.preventDefault();var t=e.target,n=new this.libs.Validation(t,this.validationOptions).valid(),i=t.dataset.uid;if(n){var r=new this.libs.FormToObject(t),o=msgStory.findMsg(i);if(o&&o.custom_fields){var s=o.custom_fields.elements;r=Object.entries(r).reduce((function(e,t){var n=_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(t,2),i=n[0],r=n[1];e[i]=r;var o=s.find((function(e){return e.field===i}));if(o)switch(o.display_type){case"boolean":"true"===r&&(e[i]=!0),"false"===r&&(e[i]=!1);break;case"numeric":""!==r&&(e[i]=parseFloat(r));break;case"integer":""!==r&&(e[i]=parseInt(r))}return e}),{})}r=Object.entries(r).reduce((function(e,t){var n=_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(t,2),i=n[0],r=n[1];return 0===i.indexOf("properties.")?(e.properties=e.properties||{},e.properties[i.replace("properties.","")]=r):e[i]=r,e}),{}),this.app.pusherNewSurveyMsg(i,r),t.querySelector("button").disabled=!0}}},{key:"clickProductAttachment",value:function clickProductAttachment(e){var el=e.target,offer=JSON.parse(el.dataset.data),callbackLabel=el.dataset.callback_label,settings=this.app.settings.behavior.attachment_cta.product,callback=function callback(){callbackLabel&&(el.innerHTML=callbackLabel),settings.callback&&eval(settings.callback)(offer)};el.handlerDone||(el.handlerDone=!0,el.setAttribute("disabled",!0),eval(settings.handler)(offer,callback))}},{key:"onFocus",value:function(){this.windowFocus=!0,stopBlink()}},{key:"onBlur",value:function(){this.windowFocus=!1}},{key:"showChat",value:function(){this.collapsed=!1,this.renderChatToggle()}},{key:"hideChat",value:function(){this.collapsed=!0,this.renderChatToggle()}},{key:"renderChatToggle",value:function(){var e=this;this.collapsed!==this.oldCollapsed&&(this.oldCollapsed=this.collapsed,this.collapsed?(helpers.removeClass(document.documentElement,this.htmlClassName),helpers.removeClass(this.elContainer,this.containerChatClassName),this.showBeacon()):(helpers.addClass(document.documentElement,this.htmlClassName),helpers.addClass(this.elContainer,this.containerChatClassName),this.hideBeacon()),this.previewMode||(this.app.handlerCollapse(this.collapsed),this.collapsed||setTimeout((function(){e.elInput.focus()}),100)))}},{key:"showBeacon",value:function(e){"disabled"!==this.app.settings.beaconState&&("hidden"!==this.app.settings.beaconState||e)&&helpers.addClass(this.elContainer,this.containerBeaconClassName)}},{key:"hideBeacon",value:function(){helpers.removeClass(this.elContainer,this.containerBeaconClassName)}},{key:"connected",value:function(){this.enableSending()}},{key:"disconnected",value:function(){this.disableSending()}},{key:"startTyping",value:function(){var e=this;this.timeoutTyping||(this.timeoutTyping=setTimeout((function(){e.sendTyping(),e.stopTyping()}),this.typingTimeout))}},{key:"stopTyping",value:function(){clearTimeout(this.timeoutTyping),this.timeoutTyping=null}},{key:"sendTyping",value:function(){var e=this.elInput.value;this.app.pusherTyping(e)}},{key:"sendMsg",value:function(){var e=this;if(this.allowSending){var t=this.elInput.value.trim();t&&(this.stopTyping(),this.disableSending(),this.app.pusherNewMsg(t).receive("ok",(function(){e.elInput.value=null,e.setMsgHeight(),e.enableSending()})).receive("error",(function(){return e.enableSending.bind(e)})).receive("timeout",(function(){return e.enableSending.bind(e)})))}}},{key:"setMsgHeight",value:function(){this.elInput.style.height="auto";var e=this.elInput.scrollHeight;this.elInput.style.height=e+"px"}},{key:"disableSending",value:function(){this.allowSending=!1,this.elSubmit&&helpers.addClass(this.elSubmit,"mkz-c__submit_disabled_yes")}},{key:"enableSending",value:function(){this.allowSending=!0,this.elSubmit&&helpers.removeClass(this.elSubmit,"mkz-c__submit_disabled_yes")}},{key:"visibleChat",value:function(){helpers.addClass(this.elContainer,"mkz-c_display_yes")}},{key:"assignAgent",value:function(){if(this.elAgentName.innerText=this.app.currentAgent.name||"",this.app.settings.appearance.agent_post&&(this.elAgentPost.innerText=this.app.currentAgent.job_title||""),this.app.settings.appearance.agent_avatar){var e=this.app.currentAgent.avatar_url||this.defaultAvatar;this.elAgentAvatar.src=e,this.elAgentAvatar.setAttribute("srcset",helpers.srcset(e)),this.elAgentAvatar.style.display="block"}else this.elAgentAvatar.style.display="none";helpers.addClass(this.elContainer,"mkz-c_agent_assign")}},{key:"unassignAgent",value:function(){helpers.removeClass(this.elContainer,"mkz-c_agent_assign")}},{key:"onlineAgents",value:function(){helpers.addClass(this.elContainer,"mkz-c_agent_online")}},{key:"offlineAgents",value:function(){helpers.removeClass(this.elContainer,"mkz-c_agent_online")}},{key:"toggleNotice",value:function(){var e=this;if(!this.previewMode){sessionStorage.getItem("mkz_c_tooltip_hidden")||(sessionStorage.setItem("mkz_c_tooltip_hidden",!0),setTimeout((function(){e.showNotice()}),this.noticeShowTimeout),setTimeout((function(){e.hideNotice()}),this.noticeShowTimeout+this.noticeHideTimeout))}}},{key:"showNotice",value:function(){helpers.addClass(this.elContainer,"mkz-c_tooltip_yes")}},{key:"hideNotice",value:function(){helpers.removeClass(this.elContainer,"mkz-c_tooltip_yes")}},{key:"render",value:function(){this.el||(this.el=helpers.appendHTML(document.body,this.template.content()),this.elContainer=this.el.querySelector(".mkz-c-js"),this.elInput=this.el.querySelector(".mkz-c-js-input"),this.elSubmit=this.el.querySelector(".mkz-c-js-submit"),this.elUnread=this.el.querySelector(".mkz-c-js-unread"),this.elClose=this.el.querySelector(".mkz-c-js-close"),this.elToggle=this.el.querySelector(".mkz-c-js-toggle"),this.elHistory=this.el.querySelector(".mkz-c-js-history"),this.elScroll=this.el.querySelector(".mkz-c-js-scroll"),this.elAgentName=this.el.querySelector(".mkz-c-js-agent-name"),this.elAgentPost=this.el.querySelector(".mkz-c-js-agent-post"),this.elAgentAvatar=this.el.querySelector(".mkz-c-js-agent-avatar"),this.bind(),this.showBeacon(),this.toggleNotice(),this.renderMessages(),this.previewMode||this.setZoom(),this.app.isMobile?helpers.addClass(document.documentElement,this.mobileClassName):helpers.removeClass(document.documentElement,this.mobileClassName)),this.renderChatToggle(),this.renderUnread()}},{key:"renderMessages",value:function(){var e,t=_createForOfIteratorHelper(this.history||msgStory.getHistory());try{for(t.s();!(e=t.n()).done;){var n=e.value;this.renderMessage(n)}}catch(e){t.e(e)}finally{t.f()}}},{key:"renderMessage",value:function(e,t,n){n&&"agent"===e.sender_type&&(this.windowFocus||startBlink(translations[this.app.locale].new_message));var i=this.template.message(e),r=this.findMsg(e.muid);if(r)r.innerHTML=i;else{var o=t&&this.findMsg(t.muid);r=o?helpers.beforeHTML(o,i):helpers.appendHTML(this.elHistory,i)}this.bindMessage(r)}},{key:"findMsg",value:function(e){return this.elHistory.querySelector('[data-id="'.concat(e,'"]'))}},{key:"renderUnread",value:function(){if(this.elUnread){var e=msgDelivered.getList().length;this.elUnread.innerHTML=e,this.elUnread.style.display=0===e?"none":"block"}}},{key:"renderAgentState",value:function(){this.app.agentIsOnline?this.onlineAgents():this.offlineAgents()}},{key:"scrollBottom",value:function(){var e=this;setTimeout((function(){e.elScroll.scrollTop=e.elScroll.scrollHeight}),0)}}]),View}()},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}return n}}},function(e,t,n){var i=n(17);e.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){t.markdown=n(20),t.parse=t.markdown.toHTML},function(e,t,n){!function(e){var t=e.Markdown=function(e){switch(typeof e){case"undefined":this.dialect=t.dialects.Gruber;break;case"object":this.dialect=e;break;default:if(!(e in t.dialects))throw new Error("Unknown Markdown dialect '"+String(e)+"'");this.dialect=t.dialects[e]}this.em_state=[],this.strong_state=[],this.debug_indent=""};function i(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function r(){var e=n(21);return"Markdown.mk_block( "+e.inspect(this.toString())+", "+e.inspect(this.trailing)+", "+e.inspect(this.lineNumber)+" )"}e.parse=function(e,n){return new t(n).toTree(e)},e.toHTML=function(t,n,i){var r=e.toHTMLTree(t,n,i);return e.renderJsonML(r)},e.toHTMLTree=function(e,t,n){"string"==typeof e&&(e=this.parse(e,t));var i=d(e),r={};i&&i.references&&(r=i.references);var o=function e(t,n,i){var r;i=i||{};var o=t.slice(0);"function"==typeof i.preprocessTreeNode&&(o=i.preprocessTreeNode(o,n));var s=d(o);if(s){for(r in o[1]={},s)o[1][r]=s[r];s=o[1]}if("string"==typeof o)return o;switch(o[0]){case"header":o[0]="h"+o[1].level,delete o[1].level;break;case"bulletlist":o[0]="ul";break;case"numberlist":o[0]="ol";break;case"listitem":o[0]="li";break;case"para":o[0]="p";break;case"markdown":o[0]="html",s&&delete s.references;break;case"code_block":o[0]="pre",r=s?2:1;var a=["code"];a.push.apply(a,o.splice(r,o.length-r)),o[r]=a;break;case"inlinecode":o[0]="code";break;case"img":o[1].src=o[1].href,delete o[1].href;break;case"linebreak":o[0]="br";break;case"link":o[0]="a";break;case"link_ref":if(o[0]="a",!(l=n[s.ref]))return s.original;delete s.ref,s.href=l.href,l.title&&(s.title=l.title),delete s.original;break;case"img_ref":var l;if(o[0]="img",!(l=n[s.ref]))return s.original;delete s.ref,s.src=l.href,l.title&&(s.title=l.title),delete s.original}if(r=1,s){for(var c in o[1]){r=2;break}1===r&&o.splice(r,1)}for(;r<o.length;++r)o[r]=e(o[r],n,i);return o}(e,r,n);return function e(t){var n=d(t)?2:1;for(;n<t.length;)"string"==typeof t[n]?n+1<t.length&&"string"==typeof t[n+1]?t[n]+=t.splice(n+1,1)[0]:++n:(e(t[n]),++n)}(o),o};var o=t.mk_block=function(e,t,n){1==arguments.length&&(t="\n\n");var o=new String(e);return o.trailing=t,o.inspect=r,o.toSource=i,null!=n&&(o.lineNumber=n),o};function s(e){for(var t=0,n=-1;-1!==(n=e.indexOf("\n",n+1));)t++;return t}function l(e,t){var n=e+"_state",i="strong"==e?"em_state":"strong_state";function r(e){this.len_after=e,this.name="close_"+t}return function(o,s){if(this[n][0]==t)return this[n].shift(),[o.length,new r(o.length-t.length)];var a=this[i].slice(),l=this[n].slice();this[n].unshift(t);var c=this.processInline(o.substr(t.length)),h=c[c.length-1];this[n].shift();return h instanceof r?(c.pop(),[o.length-h.len_after,[e].concat(c)]):(this[i]=a,this[n]=l,[t.length,t])}}t.prototype.split_blocks=function(e,t){e=e.replace(/(\r\n|\n|\r)/g,"\n");var n,i=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,r=[],a=1;for(null!=(n=/^(\s*\n)/.exec(e))&&(a+=s(n[0]),i.lastIndex=n[0].length);null!==(n=i.exec(e));)"\n#"==n[2]&&(n[2]="\n",i.lastIndex--),r.push(o(n[1],n[2],a)),a+=s(n[0]);return r},t.prototype.processBlock=function(e,t){var n=this.dialect.block,i=n.__order__;if("__call__"in n)return n.__call__.call(this,e,t);for(var r=0;r<i.length;r++){var o=n[i[r]].call(this,e,t);if(o)return(!h(o)||o.length>0&&!h(o[0]))&&this.debug(i[r],"didn't return a proper array"),o}return[]},t.prototype.processInline=function(e){return this.dialect.inline.__call__.call(this,String(e))},t.prototype.toTree=function(e,t){var n=e instanceof Array?e:this.split_blocks(e),i=this.tree;try{for(this.tree=t||this.tree||["markdown"];n.length;){var r=this.processBlock(n.shift(),n);r.length&&this.tree.push.apply(this.tree,r)}return this.tree}finally{t&&(this.tree=i)}},t.prototype.debug=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,e),"undefined"!=typeof console&&void 0!==console.log&&console.log.apply(null,e)},t.prototype.loop_re_over_block=function(e,t,n){for(var i,r=t.valueOf();r.length&&null!=(i=e.exec(r));)r=r.substr(i[0].length),n.call(this,i);return r},t.dialects={},t.dialects.Gruber={block:{atxHeader:function(e,t){var n=e.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(n){var i=["header",{level:n[1].length}];return Array.prototype.push.apply(i,this.processInline(n[2])),n[0].length<e.length&&t.unshift(o(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[i]}},setextHeader:function(e,t){var n=e.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(n){var i=["header",{level:"="===n[2]?1:2},n[1]];return n[0].length<e.length&&t.unshift(o(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[i]}},code:function(e,t){var n=[],i=/^(?: {0,3}\t| {4})(.*)\n?/;if(e.match(i)){e:for(;;){var r=this.loop_re_over_block(i,e.valueOf(),(function(e){n.push(e[1])}));if(r.length){t.unshift(o(r,e.trailing));break e}if(!t.length)break e;if(!t[0].match(i))break e;n.push(e.trailing.replace(/[^\n]/g,"").substring(2)),e=t.shift()}return[["code_block",n.join("\n")]]}},horizRule:function(e,t){var n=e.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(n){var i=[["hr"]];return n[1]&&i.unshift.apply(i,this.processBlock(n[1],[])),n[3]&&t.unshift(o(n[3])),i}},lists:function(){var e=/[*+-]/,t=new RegExp("^( {0,3})([*+-]|\\d+\\.)[ \t]+"),n="(?: {0,3}\\t| {4})";function i(e,t,n,i){if(t)e.push(["para"].concat(n));else{var r=e[e.length-1]instanceof Array&&"para"==e[e.length-1][0]?e[e.length-1]:e;i&&e.length>1&&n.unshift(i);for(var o=0;o<n.length;o++){var s=n[o];"string"==typeof s&&r.length>1&&"string"==typeof r[r.length-1]?r[r.length-1]+=s:r.push(s)}}}function r(e,t){for(var i=new RegExp("^("+n+"{"+e+"}.*?\\n?)*$"),r=new RegExp("^"+n+"{"+e+"}","gm"),s=[];t.length>0&&i.exec(t[0]);){var a=t.shift(),l=a.replace(r,"");s.push(o(l,a.trailing,a.lineNumber))}return s}function s(e,t,n){var i=e.list,r=i[i.length-1];if(!(r[1]instanceof Array&&"para"==r[1][0]))if(t+1==n.length)r.push(["para"].concat(r.splice(1,r.length-1)));else{var o=r.pop();r.push(["para"].concat(r.splice(1,r.length-1)),o)}}return function(o,a){var l=o.match(t);if(l){for(var h,u,d,p=[],m=T(l),f=!1,_=[p[0].list];;){for(var g=o.split(/(?=\n)/),k="",b=0;b<g.length;b++){var v="",z=g[b].replace(/^\n/,(function(e){return v=e,""})),y=(d=p.length,new RegExp("(?:^("+n+"{0,"+d+"} {0,3})([*+-]|\\d+\\.)\\s+)|(^"+n+"{0,"+(d-1)+"}[ ]{0,4})"));if(void 0!==(l=z.match(y))[1]){k.length&&(i(h,f,this.processInline(k),v),f=!1,k=""),l[1]=l[1].replace(/ {0,3}\t/g,"    ");var x=Math.floor(l[1].length/4)+1;if(x>p.length)m=T(l),h.push(m),h=m[1]=["listitem"];else{var w=!1;for(u=0;u<p.length;u++)if(p[u].indent==l[1]){m=p[u].list,p.splice(u+1,p.length-(u+1)),w=!0;break}w||(++x<=p.length?(p.splice(x,p.length-x),m=p[x-1].list):(m=T(l),h.push(m))),h=["listitem"],m.push(h)}v=""}z.length>l[0].length&&(k+=v+z.substr(l[0].length))}k.length&&(i(h,f,this.processInline(k),v),f=!1,k="");var C=r(p.length,a);C.length>0&&(c(p,s,this),h.push.apply(h,this.toTree(C,[])));var S=a[0]&&a[0].valueOf()||"";if(!S.match(t)&&!S.match(/^ /))break;o=a.shift();var E=this.dialect.block.horizRule(o,a);if(E){_.push.apply(_,E);break}c(p,s,this),f=!0}return _}function T(t){var n=e.exec(t[2])?["bulletlist"]:["numberlist"];return p.push({list:n,indent:t[1]}),n}}}(),blockquote:function(e,t){if(e.match(/^>/m)){var n=[];if(">"!=e[0]){for(var i=e.split(/\n/),r=[],s=e.lineNumber;i.length&&">"!=i[0][0];)r.push(i.shift()),s++;var a=o(r.join("\n"),"\n",e.lineNumber);n.push.apply(n,this.processBlock(a,[])),e=o(i.join("\n"),e.trailing,s)}for(;t.length&&">"==t[0][0];){var l=t.shift();e=o(e+e.trailing+l,l.trailing,e.lineNumber)}var c=e.replace(/^> ?/gm,""),h=(this.tree,this.toTree(c,["blockquote"])),p=d(h);return p&&p.references&&(delete p.references,u(p)&&h.splice(1,1)),n.push(h),n}},referenceDefn:function(e,t){var n=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(e.match(n)){d(this.tree)||this.tree.splice(1,0,{});var i=d(this.tree);void 0===i.references&&(i.references={});var r=this.loop_re_over_block(n,e,(function(e){e[2]&&"<"==e[2][0]&&">"==e[2][e[2].length-1]&&(e[2]=e[2].substring(1,e[2].length-1));var t=i.references[e[1].toLowerCase()]={href:e[2]};void 0!==e[4]?t.title=e[4]:void 0!==e[5]&&(t.title=e[5])}));return r.length&&t.unshift(o(r,e.trailing)),[]}},para:function(e,t){return[["para"].concat(this.processInline(e))]}}},t.dialects.Gruber.inline={__oneElement__:function(e,t,n){var i,r;return t=t||this.dialect.inline.__patterns__,(i=new RegExp("([\\s\\S]*?)("+(t.source||t)+")").exec(e))?i[1]?[i[1].length,i[1]]:(i[2]in this.dialect.inline&&(r=this.dialect.inline[i[2]].call(this,e.substr(i.index),i,n||[])),r=r||[i[2].length,i[2]]):[e.length,e]},__call__:function(e,t){var n,i=[];function r(e){"string"==typeof e&&"string"==typeof i[i.length-1]?i[i.length-1]+=e:i.push(e)}for(;e.length>0;)n=this.dialect.inline.__oneElement__.call(this,e,t,i),e=e.substr(n.shift()),c(n,r);return i},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function(e){return this.dialect.inline.__escape__.exec(e)?[2,e.charAt(1)]:[1,"\\"]},"![":function(e){var t=e.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(t){t[2]&&"<"==t[2][0]&&">"==t[2][t[2].length-1]&&(t[2]=t[2].substring(1,t[2].length-1)),t[2]=this.dialect.inline.__call__.call(this,t[2],/\\/)[0];var n={alt:t[1],href:t[2]||""};return void 0!==t[4]&&(n.title=t[4]),[t[0].length,["img",n]]}return(t=e.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/))?[t[0].length,["img_ref",{alt:t[1],ref:t[2].toLowerCase(),original:t[0]}]]:[2,"!["]},"[":function(e){var n=String(e),i=t.DialectHelpers.inline_until_char.call(this,e.substr(1),"]");if(!i)return[1,"["];var r,o,s=1+i[0],a=i[1],l=(e=e.substr(s)).match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(l){var c=l[1];if(s+=l[0].length,c&&"<"==c[0]&&">"==c[c.length-1]&&(c=c.substring(1,c.length-1)),!l[3])for(var h=1,u=0;u<c.length;u++)switch(c[u]){case"(":h++;break;case")":0==--h&&(s-=c.length-u,c=c.substring(0,u))}return o={href:(c=this.dialect.inline.__call__.call(this,c,/\\/)[0])||""},void 0!==l[3]&&(o.title=l[3]),r=["link",o].concat(a),[s,r]}return(l=e.match(/^\s*\[(.*?)\]/))?(s+=l[0].length,r=["link_ref",o={ref:(l[1]||String(a)).toLowerCase(),original:n.substr(0,s)}].concat(a),[s,r]):1==a.length&&"string"==typeof a[0]?(r=["link_ref",o={ref:a[0].toLowerCase(),original:n.substr(0,s)},a[0]],[s,r]):[1,"["]},"<":function(e){var t;return null!=(t=e.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?t[3]?[t[0].length,["link",{href:"mailto:"+t[3]},t[3]]]:"mailto"==t[2]?[t[0].length,["link",{href:t[1]},t[1].substr("mailto:".length)]]:[t[0].length,["link",{href:t[1]},t[1]]]:[1,"<"]},"`":function(e){var t=e.match(/(`+)(([\s\S]*?)\1)/);return t&&t[2]?[t[1].length+t[2].length,["inlinecode",t[3]]]:[1,"`"]},"  \n":function(e){return[3,["linebreak"]]}},t.dialects.Gruber.inline["**"]=l("strong","**"),t.dialects.Gruber.inline.__=l("strong","__"),t.dialects.Gruber.inline["*"]=l("em","*"),t.dialects.Gruber.inline._=l("em","_"),t.buildBlockOrder=function(e){var t=[];for(var n in e)"__order__"!=n&&"__call__"!=n&&t.push(n);e.__order__=t},t.buildInlinePatterns=function(e){var t=[];for(var n in e)if(!n.match(/^__.*__$/)){var i=n.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");t.push(1==n.length?i:"(?:"+i+")")}t=t.join("|"),e.__patterns__=t;var r=e.__call__;e.__call__=function(e,n){return null!=n?r.call(this,e,n):r.call(this,e,t)}},t.DialectHelpers={},t.DialectHelpers.inline_until_char=function(e,t){for(var n=0,i=[];;){if(e.charAt(n)==t)return[++n,i];if(n>=e.length)return null;var r=this.dialect.inline.__oneElement__.call(this,e.substr(n));n+=r[0],i.push.apply(i,r.slice(1))}},t.subclassDialect=function(e){function t(){}function n(){}return t.prototype=e.block,n.prototype=e.inline,{block:new t,inline:new n}},t.buildBlockOrder(t.dialects.Gruber.block),t.buildInlinePatterns(t.dialects.Gruber.inline),t.dialects.Maruku=t.subclassDialect(t.dialects.Gruber),t.dialects.Maruku.processMetaHash=function(e){for(var t=function(e){var t=e.split(""),n=[""],i=!1;for(;t.length;){var r=t.shift();switch(r){case" ":i?n[n.length-1]+=r:n.push("");break;case"'":case'"':i=!i;break;case"\\":r=t.shift();default:n[n.length-1]+=r}}return n}(e),n={},i=0;i<t.length;++i)if(/^#/.test(t[i]))n.id=t[i].substring(1);else if(/^\./.test(t[i]))n.class?n.class=n.class+t[i].replace(/./," "):n.class=t[i].substring(1);else if(/\=/.test(t[i])){var r=t[i].split(/\=/);n[r[0]]=r[1]}return n},t.dialects.Maruku.block.document_meta=function(e,t){if(!(e.lineNumber>1)&&e.match(/^(?:\w+:.*\n)*\w+:.*$/)){d(this.tree)||this.tree.splice(1,0,{});var n=e.split(/\n/);for(p in n){var i=n[p].match(/(\w+):\s*(.*)$/),r=i[1].toLowerCase(),o=i[2];this.tree[1][r]=o}return[]}},t.dialects.Maruku.block.block_meta=function(e,t){var n=e.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(n){var i,r=this.dialect.processMetaHash(n[2]);if(""===n[1]){var o=this.tree[this.tree.length-1];if(i=d(o),"string"==typeof o)return;for(a in i||(i={},o.splice(1,0,i)),r)i[a]=r[a];return[]}var s=e.replace(/\n.*$/,""),l=this.processBlock(s,[]);for(a in(i=d(l[0]))||(i={},l[0].splice(1,0,i)),r)i[a]=r[a];return l}},t.dialects.Maruku.block.definition_list=function(e,t){var n,i=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,r=["dl"];if(a=e.match(i)){for(var o=[e];t.length&&i.exec(t[0]);)o.push(t.shift());for(var s=0;s<o.length;++s){var a,l=(a=o[s].match(i))[1].replace(/\n$/,"").split(/\n/),c=a[2].split(/\n:\s+/);for(n=0;n<l.length;++n)r.push(["dt",l[n]]);for(n=0;n<c.length;++n)r.push(["dd"].concat(this.processInline(c[n].replace(/(\n)\s+/,"$1"))))}return[r]}},t.dialects.Maruku.block.table=function(e,t){var n,i,r=function(e,t){(t=t||"\\s").match(/^[\\|\[\]{}?*.+^$]$/)&&(t="\\"+t);for(var n,i=[],r=new RegExp("^((?:\\\\.|[^\\\\"+t+"])*)"+t+"(.*)");n=e.match(r);)i.push(n[1]),e=n[2];return i.push(e),i};if(i=e.match(/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/))i[3]=i[3].replace(/^\s*\|/gm,"");else if(!(i=e.match(/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/)))return;var o=["table",["thead",["tr"]],["tbody"]];i[2]=i[2].replace(/\|\s*$/,"").split("|");var s=[];for(c(i[2],(function(e){e.match(/^\s*-+:\s*$/)?s.push({align:"right"}):e.match(/^\s*:-+\s*$/)?s.push({align:"left"}):e.match(/^\s*:-+:\s*$/)?s.push({align:"center"}):s.push({})})),i[1]=r(i[1].replace(/\|\s*$/,""),"|"),n=0;n<i[1].length;n++)o[1][1].push(["th",s[n]||{}].concat(this.processInline(i[1][n].trim())));return c(i[3].replace(/\|\s*$/gm,"").split("\n"),(function(e){var t=["tr"];for(e=r(e,"|"),n=0;n<e.length;n++)t.push(["td",s[n]||{}].concat(this.processInline(e[n].trim())));o[2].push(t)}),this),[o]},t.dialects.Maruku.inline["{:"]=function(e,t,n){if(!n.length)return[2,"{:"];var i=n[n.length-1];if("string"==typeof i)return[2,"{:"];var r=e.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!r)return[2,"{:"];var o=this.dialect.processMetaHash(r[1]),s=d(i);for(var a in s||(s={},i.splice(1,0,s)),o)s[a]=o[a];return[r[0].length,""]},t.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,t.buildBlockOrder(t.dialects.Maruku.block),t.buildInlinePatterns(t.dialects.Maruku.inline);var c,h=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)};c=Array.prototype.forEach?function(e,t,n){return e.forEach(t,n)}:function(e,t,n){for(var i=0;i<e.length;i++)t.call(n||e,e[i],i,e)};var u=function(e){for(var t in e)if(hasOwnProperty.call(e,t))return!1;return!0};function d(e){return h(e)&&e.length>1&&"object"==typeof e[1]&&!h(e[1])?e[1]:void 0}function m(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function f(e){if("string"==typeof e)return m(e);var t=e.shift(),n={},i=[];for(!e.length||"object"!=typeof e[0]||e[0]instanceof Array||(n=e.shift());e.length;)i.push(f(e.shift()));var r="";for(var o in n)r+=" "+o+'="'+m(n[o])+'"';return"img"==t||"br"==t||"hr"==t?"<"+t+r+"/>":"<"+t+r+">"+i.join("")+"</"+t+">"}e.renderJsonML=function(e,t){(t=t||{}).root=t.root||!1;var n=[];if(t.root)n.push(f(e));else for(e.shift(),!e.length||"object"!=typeof e[0]||e[0]instanceof Array||e.shift();e.length;)n.push(f(e.shift()));return n.join("\n\n")}}(t)},function(e,t,n){(function(e){var i=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},i=0;i<t.length;i++)n[t[i]]=Object.getOwnPropertyDescriptor(e,t[i]);return n},r=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var i=arguments,o=i.length,s=String(e).replace(r,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return e}})),l=i[n];n<o;l=i[++n])f(l)||!v(l)?s+=" "+l:s+=" "+a(l);return s},t.deprecate=function(n,i){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,i).apply(this,arguments)};var r=!1;return function(){if(!r){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),r=!0}return n.apply(this,arguments)}};var o,s={};function a(e,n){var i={seen:[],stylize:c};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),m(n)?i.showHidden=n:n&&t._extend(i,n),k(i.showHidden)&&(i.showHidden=!1),k(i.depth)&&(i.depth=2),k(i.colors)&&(i.colors=!1),k(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=l),h(i,e,i.depth)}function l(e,t){var n=a.styles[t];return n?"["+a.colors[n][0]+"m"+e+"["+a.colors[n][1]+"m":e}function c(e,t){return e}function h(e,n,i){if(e.customInspect&&n&&x(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var r=n.inspect(i,e);return g(r)||(r=h(e,r,i)),r}var o=function(e,t){if(k(t))return e.stylize("undefined","undefined");if(g(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(_(t))return e.stylize(""+t,"number");if(m(t))return e.stylize(""+t,"boolean");if(f(t))return e.stylize("null","null")}(e,n);if(o)return o;var s=Object.keys(n),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),y(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return u(n);if(0===s.length){if(x(n)){var l=n.name?": "+n.name:"";return e.stylize("[Function"+l+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(z(n))return e.stylize(Date.prototype.toString.call(n),"date");if(y(n))return u(n)}var c,v="",w=!1,C=["{","}"];(p(n)&&(w=!0,C=["[","]"]),x(n))&&(v=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(v=" "+RegExp.prototype.toString.call(n)),z(n)&&(v=" "+Date.prototype.toUTCString.call(n)),y(n)&&(v=" "+u(n)),0!==s.length||w&&0!=n.length?i<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=w?function(e,t,n,i,r){for(var o=[],s=0,a=t.length;s<a;++s)T(t,String(s))?o.push(d(e,t,n,i,String(s),!0)):o.push("");return r.forEach((function(r){r.match(/^\d+$/)||o.push(d(e,t,n,i,r,!0))})),o}(e,n,i,a,s):s.map((function(t){return d(e,n,i,a,t,w)})),e.seen.pop(),function(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(c,v,C)):C[0]+v+C[1]}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,i,r,o){var s,a,l;if((l=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]}).get?a=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(a=e.stylize("[Setter]","special")),T(i,r)||(s="["+r+"]"),a||(e.seen.indexOf(l.value)<0?(a=f(n)?h(e,l.value,null):h(e,l.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),k(s)){if(o&&r.match(/^\d+$/))return a;(s=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function p(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function f(e){return null===e}function _(e){return"number"==typeof e}function g(e){return"string"==typeof e}function k(e){return void 0===e}function b(e){return v(e)&&"[object RegExp]"===w(e)}function v(e){return"object"==typeof e&&null!==e}function z(e){return v(e)&&"[object Date]"===w(e)}function y(e){return v(e)&&("[object Error]"===w(e)||e instanceof Error)}function x(e){return"function"==typeof e}function w(e){return Object.prototype.toString.call(e)}function C(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(k(o)&&(o=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var i=e.pid;s[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,i,e)}}else s[n]=function(){};return s[n]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=m,t.isNull=f,t.isNullOrUndefined=function(e){return null==e},t.isNumber=_,t.isString=g,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=k,t.isRegExp=b,t.isObject=v,t.isDate=z,t.isError=y,t.isFunction=x,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(23);var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(){var e=new Date,t=[C(e.getHours()),C(e.getMinutes()),C(e.getSeconds())].join(":");return[e.getDate(),S[e.getMonth()],t].join(" ")}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",E(),t.format.apply(t,arguments))},t.inherits=n(24),t._extend=function(e,t){if(!t||!v(t))return e;for(var n=Object.keys(t),i=n.length;i--;)e[n[i]]=t[n[i]];return e};var j="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(j&&e[j]){var t;if("function"!=typeof(t=e[j]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,j,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,i=new Promise((function(e,i){t=e,n=i})),r=[],o=0;o<arguments.length;o++)r.push(arguments[o]);r.push((function(e,i){e?n(e):t(i)}));try{e.apply(this,r)}catch(e){n(e)}return i}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),j&&Object.defineProperty(t,j,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,i(e))},t.promisify.custom=j,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],i=0;i<arguments.length;i++)n.push(arguments[i]);var r=n.pop();if("function"!=typeof r)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return r.apply(o,arguments)};t.apply(this,n).then((function(t){e.nextTick(s,null,t)}),(function(t){e.nextTick(A,t,s)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,i(t)),n}}).call(this,n(22))},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var l,c=[],h=!1,u=-1;function d(){h&&l&&(h=!1,l.length?c=l.concat(c):u=-1,c.length&&p())}function p(){if(!h){var e=a(d);h=!0;for(var t=c.length;t;){for(l=c,c=[];++u<t;)l&&l[u].run();u=-1,t=c.length}l=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new m(e,t)),1!==c.length||h||a(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){e.exports={guid:0,fixEvent:function(e){if((e=e||window.event).isFixed)return e;if(e.isFixed=!0,e.preventDefault=e.preventDefault||function(){this.returnValue=!1},e.stopPropagation=e.stopPropagaton||function(){this.cancelBubble=!0},e.target||(e.target=e.srcElement),!e.relatedTarget&&e.fromElement&&(e.relatedTarget=e.fromElement==e.target?e.toElement:e.fromElement),null==e.pageX&&null!=e.clientX){var t=document.documentElement,n=document.body;e.pageX=e.clientX+(t&&t.scrollLeft||n&&n.scrollLeft||0)-(t.clientLeft||0),e.pageY=e.clientY+(t&&t.scrollTop||n&&n.scrollTop||0)-(t.clientTop||0)}return!e.which&&e.button&&(e.which=1&e.button?1:2&e.button?3:4&e.button?2:0),e},commonHandle:function(e,t){e=t.fixEvent(e);var n=this.events[e.type];for(var i in n){if(!1===n[i].call(this,e)&&(e.preventDefault(),e.stopPropagation()),e.stopNow)break}},add:function(e,t,n){var i=this;e.setInterval&&e!=window&&!e.frameElement&&(e=window),n.guid||(n.guid=++this.guid),e.events||(e.events={},e.handle=function(t){return i.commonHandle.call(e,t,i)}),e.events[t]||(e.events[t]={},e.addEventListener?e.addEventListener(t,e.handle,!1):e.attachEvent&&e.attachEvent("on"+t,e.handle)),e.events[t][n.guid]=n},remove:function(e,t,n){var i=e.events&&e.events[t];if(i){for(var r in delete i[n.guid],i)return;for(var r in e.removeEventListener?e.removeEventListener(t,e.handle,!1):e.detachEvent&&e.detachEvent("on"+t,e.handle),delete e.events[t],e.events)return;try{delete e.handle,delete e.events}catch(t){e.removeAttribute("handle"),e.removeAttribute("events")}}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"startBlink",(function(){return h})),n.d(t,"stopBlink",(function(){return u}));var i=n(0),r=n.n(i),o=n(1),s=n.n(o),a=function(){function e(){r()(this,e),this.sprites=[],this.step=0,this.interval=0,this.delay=600,this.fetchLinks(),this.generateSprites(2,16,16,"red")}return s()(e,[{key:"fetchLinks",value:function(){var e=document.head.querySelectorAll('link[type="image/png"], link[type="image/x-icon"]');this.links=Object.values(e).map((function(e){return{el:e,originalUrl:e.href,originalType:e.type}}))}},{key:"generateSprites",value:function(e,t,n,i){for(var r=0;r<e;r++){var o=document.createElement("canvas");o.width=t,o.height=n;var s=t/(3*(r+1)),a=t/2,l=n/2,c=o.getContext("2d");c.beginPath(),c.arc(a,l,s,0,2*Math.PI,!1),c.fillStyle=i,c.fill(),this.sprites.push(o.toDataURL())}}},{key:"start",value:function(){var e=this;if(!this.interval){var t=function(){e.links.map((function(t){t.el.href=e.sprites[e.step%e.sprites.length],t.el.type="image/png"})),e.step++};t(),this.interval=setInterval((function(){t()}),this.delay)}}},{key:"stop",value:function(){clearInterval(this.interval),this.interval=null,this.links.map((function(e){e.el.href=e.originalUrl,e.el.type=e.originalType}))}}]),e}(),l=new(function(){function e(){r()(this,e),this.delay=1200,this.showed=!1,this.interval=null,this.defaultTitle=null,this.title=null}return s()(e,[{key:"start",value:function(e){e&&(this.title=e,this.interval||(this.toggle(),this.interval=setInterval(this.toggle.bind(this),this.delay)))}},{key:"stop",value:function(){null!==this.interval&&(clearInterval(this.interval),this.interval=null,this.hide())}},{key:"toggle",value:function(){this.showed?this.hide():this.show()}},{key:"show",value:function(){document.title!==this.defaultTitle&&(this.defaultTitle=document.title),document.title=this.title,this.showed=!0}},{key:"hide",value:function(){document.title!==this.title&&(this.defaultTitle=document.title),document.title=this.defaultTitle,this.showed=!1}}]),e}()),c=new a,h=function(e){l.start(e),c.start()},u=function(){l.stop(),c.stop()}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d}));var i=n(2),r=n.n(i),o=n(0),s=n.n(o),a=n(1),l=n.n(a),c=n(6),h=n(7),u=n(8),d=function(){function e(t){s()(this,e),this.app=t.app,this.view=t,this.appearance=this.app.settings.appearance,this.behavior=this.app.settings.behavior}return l()(e,[{key:"safe",value:function(e){return h.htmlToText(e)}},{key:"t",value:function(e){return u[this.app.locale][e]}},{key:"attribute",value:function(e){return e?e.replace(/\"/gi,"&quot;"):""}},{key:"offer",value:function(e,t,n){var i=e.icon?'\n          <img src="'.concat(this.safe(e.icon),'" alt="" class="mkz-c-o__preview-img" />\n    '):'\n          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="480" height="448" viewBox="0 0 480 448" class="mkz-c-o__preview-img">\n            <path fill="currentColor" d="M160 144c0 26.5-21.5 48-48 48s-48-21.5-48-48 21.5-48 48-48 48 21.5 48 48zM416 240v112h-352v-48l80-80 40 40 128-128zM440 64h-400c-4.25 0-8 3.75-8 8v304c0 4.25 3.75 8 8 8h400c4.25 0 8-3.75 8-8v-304c0-4.25-3.75-8-8-8zM480 72v304c0 22-18 40-40 40h-400c-22 0-40-18-40-40v-304c0-22 18-40 40-40h400c22 0 40 18 40 40z"></path>\n          </svg>\n    ',r=n.length<2?"":'\n        <div class="mkz-c-o__counter">\n          '.concat(t+1,"/").concat(n.length,"\n        </dvi>\n    "),o=this.t(this.behavior.attachment_cta.product.callback_label_text),s=this.t(this.behavior.attachment_cta.product.label_text);return'\n      <div class="mkz-c-o__i">\n        <div class="mkz-c-o__content">\n          <a href="'.concat(this.safe(e.url),'" class="mkz-c-o__preview-link">\n            ').concat(i,'\n          </a>\n          <div class="mkz-c-o__name">\n            <a href="').concat(this.safe(e.url),'" class="mkz-c-o__name-link">').concat(this.safe(e.name),'</a>\n          </div>\n          <div class="mkz-c-o__info">\n            <div class="mkz-c-o__info-price">\n              ').concat(this.safe(e.display_price),'\n            </div>\n            <div class="mkz-c-o__info-avaliable mkz-c-o__info-avaliable_color_').concat(e.available?"green":"red",'">\n              ').concat(this.t(e.available?"in_stock":"out_of_stock"),'\n            </div>\n          </div>\n          <div class="mkz-c-o__action">\n            <span\n              data-data="').concat(this.attribute(JSON.stringify(e)),'"\n              data-callback_label="').concat(this.attribute(o),'"\n              class="mkz-c-o__btn mkz-c-o-js-action"\n            >\n              ').concat(s,"\n            </span>\n          </div>\n        </div>\n        ").concat(r,"\n      </div>\n    ")}},{key:"offers",value:function(e){return e?'\n    <div class="mkz-c-o">\n      '.concat(e.map(this.offer.bind(this)).join("\n"),"\n    </div>"):""}},{key:"form",value:function(e,t){var n=this,i=e.map((function(e){switch(e.display_type){case"email":return n.formText(e,"email");case"numeric":return n.formText(e,"text","numeric");case"integer":return n.formText(e,"text","integer");case"boolean":return n.formBoolean(e);case"select":return n.formSelect(e);case"date":return n.formDate(e);case"hint":return n.formHint(e);case"button":return n.formButton(e);default:return n.formText(e,"text")}})).map((function(e){return'<div class="mkz-f__row">'.concat(e,"</div>")})).join("");return'\n      <form class="mkz-f mkz-f-js" data-uid="'.concat(this.attribute(t),'" novalidate autocomplete="off">').concat(i,"</form>")}},{key:"formText",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return'\n    <label class="mkz-f__label">'.concat(this.safe(e.display_name),'</label>\n    <input\n      type="').concat(t,'"\n      name="').concat(e.field,'"\n      class="mkz-f__input"\n      value="').concat(this.attribute(e.value),'"\n      ').concat(e.disabled?'disabled="true"':"","\n      ").concat(e.required?"required":"","\n      ").concat(n,"\n    />\n    ")}},{key:"formDate",value:function(e){return'\n    <label class="mkz-f__label">'.concat(this.safe(e.display_name),'</label>\n    <input\n      type="date"\n      name="').concat(e.field,'"\n      class="mkz-f__input"\n      pattern="[0-9]{4}-[0-9]{2}-[0-9]{2}"\n      value="').concat(this.attribute(e.value),'"\n      ').concat(e.disabled?'disabled="true"':"","\n      ").concat(e.required?"required":"","\n    />\n    ")}},{key:"formBoolean",value:function(e){var t=this,n={"":"-",true:this.t("true"),false:this.t("false")},i=Object.entries(n).map((function(n){var i=r()(n,2),o=i[0],s=i[1],a=e.value===String(o)?'selected="selected"':"";return'<option value="'.concat(t.attribute(o),'" ').concat(a,">").concat(t.safe(s),"</option>")})).join("");return'\n    <label class="mkz-f__label">'.concat(this.safe(e.display_name),'</label>\n    <select\n      name="').concat(e.field,'"\n      class="mkz-f__select"\n      ').concat(e.disabled?'disabled="true"':"","\n      ").concat(e.required?"required":"","\n    >").concat(i,"</select>\n    ")}},{key:"formSelect",value:function(e){var t=this,n=[["","-"]].concat(Object.entries(e.predefined_values)).map((function(n){var i=r()(n,2),o=i[0],s=i[1],a=e.value===o?'selected="selected"':"";return'<option value="'.concat(t.attribute(o),'" ').concat(a,">").concat(t.safe(s),"</option>")})).join("");return'\n    <label class="mkz-f__label">'.concat(this.safe(e.display_name),'</label>\n    <select\n      name="').concat(e.field,'"\n      class="mkz-f__select"\n      ').concat(e.disabled?'disabled="true"':"","\n      ").concat(e.required?"required":"","\n    >").concat(n,"</select>\n    ")}},{key:"formHint",value:function(e){return'\n    <div class="mkz-f__note">'.concat(this.safe(e.display_name),"</div>\n    ")}},{key:"formButton",value:function(e){return'\n    <button type="submit" class="mkz-f__btn" '.concat(e.disabled?'disabled="true"':"",">").concat(this.safe(e.display_name),"</button>\n    ")}},{key:"attachments",value:function(e){var t=this,n=(e.attachments||[]).reduce((function(e,t){return e[t.type]||(e[t.type]=[]),e[t.type].push(t),e}),{});return Object.entries(n).map((function(e){var n=r()(e,2),i=n[0],o=n[1];switch(i){case"product":return t.offers(o)}}))}},{key:"message",value:function(e){var t=this.app.settings.appearance.agent_avatar,n=e.sender_avatar_url||this.view.defaultAvatar,i=t?'<div class="mkz-c__i-avatar"><img src="'.concat(this.safe(n),'" srcset="').concat(h.srcset(n),'" class="mkz-c__i-avatar-img" alt="" title="').concat(this.safe(e.sender_name),'" /></div>'):"";return'\n          <div class="mkz-c__i mkz-c__i_type_'.concat("client"===e.sender_type?"client":"agent",'" data-id="').concat(e.muid,'">\n            ').concat(i,'\n            <div class="mkz-c__i-content">\n              ').concat(this.messageContent(e),"\n            </div>\n          </div>")}},{key:"messageContent",value:function(e){var t=this,n="client"===e.sender_type?this.appearance.client_msg_bg:this.appearance.agent_msg_bg,i="client"===e.sender_type?this.appearance.client_msg_color:this.appearance.agent_msg_color,r=function(e){return'\n      <div class="mkz-c__i-msg" style="background-color: '.concat(t.safe(n),"; color: ").concat(t.safe(i),'">\n        <div class="mkz-c__i-msg-overflow">\n          ').concat(e,"\n        </div>\n      </div>")};switch(e.msg_type){case"survey:show":var o=e.custom_fields,s=o.submitted,a=o.hidden,l=o.elements.map((function(e){return e.value=o.values&&o.values[e.field],e})),c=o.follow_up_text?r(h.htmlFormatting(o.follow_up_text)):"";return(e.text?r(h.htmlFormatting(e.text)):"")+(s?c:a?"":r(this.form(l,e.muid)));default:var u=h.htmlFormatting(e.text);return"\n          ".concat(u?r(u):"","\n          ").concat(this.attachments(e))}}},{key:"doc",value:function(e){return'\n            <div class="mkz-c-docs__i">\n              <div class="mkz-c-docs__btn">\n                '.concat(this.safe(e),"\n              </div>\n            </div>")}},{key:"docs",value:function(){return""}},{key:"copy",value:function(){return this.appearance.markeaze_link?'\n      <div class="mkz-c__copy-wrap">\n        <a class="mkz-c__copy" href="https://markeaze.com/?utm_source=markeaze&utm_campaign=chatbox" target="_blank">\n          <svg width="11" height="9" viewBox="0 0 10 8" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M1.94727 2.8471C2.12716 2.49158 2.57173 2.38949 2.87918 2.63311C3.12176 2.82531 3.19515 3.17138 3.05276 3.45164L1.17079 7.15577C0.991709 7.50824 0.550808 7.60949 0.24532 7.3683C0.0037509 7.17757 -0.0698014 6.83352 0.0713545 6.55454L1.94727 2.8471Z" fill="#FC4566"/>\n            <path d="M5.35667 1.9023C5.54038 1.55555 5.9926 1.45484 6.30746 1.69056C6.55814 1.87824 6.63496 2.21903 6.48885 2.49519L4.02121 7.15912C3.83664 7.50797 3.38122 7.60839 3.06569 7.36982C2.81616 7.18115 2.74036 6.8407 2.88648 6.5649L5.35667 1.9023Z" fill="#0EC52C"/>\n            <path d="M8.81247 0.351483C8.99329 -0.00816918 9.44199 -0.111851 9.75226 0.134322C9.99632 0.327953 10.0705 0.67639 9.92784 0.959046L6.80213 7.15236C6.62323 7.50684 6.18144 7.61011 5.87387 7.36934C5.62976 7.17824 5.55453 6.83147 5.6961 6.54989L8.81247 0.351483Z" fill="#7261FF"/>\n          </svg>\n          '.concat(this.t("copyright"),"\n        </a>\n      </div>"):""}},{key:"notice",value:function(){return this.appearance.notice_text&&this.appearance.notice_text.trim()?'\n      <div class="mkz-c__tooltip mkz-c__tooltip_picture_yes" style="color: '.concat(this.safe(this.appearance.notice_color),"; background-color: ").concat(this.safe(this.appearance.notice_bg),'">\n        <img src="').concat(this.safe(this.appearance.notice_icon_url),'" class="mkz-c__tooltip-picture" alt="" />\n        <div class="mkz-c__tooltip-text">\n          ').concat(this.safe(this.appearance.notice_text),"\n        </div>\n      </div>"):""}},{key:"content",value:function(){var e=["l-t","l-b","l"].indexOf(this.appearance.bar_position)>-1?"left":"right";return'\n<div mkz>\n  <div class="mkz-c mkz-c-js">\n\n    <div class="mkz-c__handler mkz-c__handler_type_'.concat(this.safe(this.appearance.bar_type)," mkz-c__handler_position_").concat(this.safe(this.appearance.bar_position)," ").concat(this.appearance.bar_bouncing?"mkz-c__handler_bouncing_yes":"",'" style="margin: ').concat(this.safe(this.appearance.bar_padding_y),"px ").concat(this.safe(this.appearance.bar_padding_x),'px">\n      ').concat(this.notice(),'\n      <div class="mkz-c__btn mkz-c-js-toggle" style="background-color: ').concat(this.appearance.bar_bg,"; color: ").concat(this.safe(this.appearance.bar_color),';">\n        <div class="mkz-c__btn-text">\n          <span class="mkz-c__btn-text-online">').concat(this.safe(this.appearance.bar_text_online),'</span>\n          <span class="mkz-c__btn-text-offline">').concat(this.safe(this.appearance.bar_text_offline),'</span>\n        </div>\n        <svg width="27" height="27" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg" class="mkz-c__btn-picture">\n          <path d="M20.6429 10.4641C20.6466 11.8783 20.3162 13.2733 19.6786 14.5355C18.9226 16.0481 17.7605 17.3204 16.3223 18.2098C14.8841 19.0992 13.2267 19.5706 11.5357 19.5713C10.1216 19.5749 8.72659 19.2445 7.46432 18.607L1.35718 20.6427L3.39289 14.5355C2.75532 13.2733 2.42492 11.8783 2.42861 10.4641C2.42926 8.77313 2.90069 7.11573 3.79009 5.67755C4.67949 4.23937 5.95174 3.07721 7.46432 2.32125C8.72659 1.68368 10.1216 1.35328 11.5357 1.35696H12.0715C14.3047 1.48017 16.414 2.42278 17.9955 4.00431C19.5771 5.58585 20.5197 7.69516 20.6429 9.92839V10.4641Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n        </svg>\n        <div class="mkz-c__btn-unread mkz-c-js-unread">0</div>\n      </div>\n    </div>\n\n    <div class="mkz-c__chat mkz-c__chat_position_').concat(e,'" style="').concat(this.view.width?"max-width: ".concat(this.view.width,"px;"):"",'">\n      <div class="mkz-c__cart-shadow"></div>\n      <div class="mkz-c__cart">\n        <div class="mkz-c__head" style="color: ').concat(this.safe(this.appearance.title_color),"; background-color: ").concat(this.safe(this.appearance.title_bg),';">\n          <div class="mkz-c__head-state">\n            <div class="mkz-c__state-wrap">\n              <img class="mkz-c__m-assign-avatar mkz-c-js-agent-avatar" alt="" />\n              <div class="mkz-c__state"></div>\n            </div>\n          </div>\n          <div class="mkz-c__head-m">\n            <div class="mkz-c__m-assign-text mkz-c-js-agent-name"></div>\n            <div class="mkz-c__m-assign-post mkz-c-js-agent-post"></div>\n            <div class="mkz-c__m-unassign-text">').concat(this.safe(this.appearance.bar_text_offline),'</div>\n          </div>\n          <div class="mkz-c__head-action">\n            <div class="mkz-c__close mkz-c-js-close">\n              <svg width="30" height="30" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path d="M11.4287 4.57129L4.57153 11.4284" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n              <path d="M4.57153 4.57129L11.4287 11.4284" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/>\n              </svg>\n            </div>\n          </div>\n        </div>\n        <div class="mkz-c__content">\n          <div class="mkz-c__scroll mkz-c-js-scroll">\n            <div class="mkz-c__list mkz-c-js-history"></div>\n          </div>\n          ').concat(this.copy(),"\n        </div>\n        ").concat(this.docs(),'\n        <label class="mkz-c__footer">\n          <div class="mkz-c__footer-msg">\n            <textarea class="mkz-c__input mkz-c-js-input" rows="1" placeholder="').concat(this.safe(this.appearance.placeholder||this.t("placeholder")),'"></textarea>\n          </div>\n          <div class="mkz-c__footer-btn">\n            <div class="mkz-c__submit mkz-c-js-submit">\n              <svg width="19" height="18" viewBox="0 0 19 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M18.9675 0.949039L12.9784 17.6706C12.9069 17.8682 12.7194 17.9999 12.5092 18H12.3495C12.1535 18 11.9749 17.8874 11.8903 17.7105L9.53462 12.719C9.18774 11.9831 9.322 11.1103 9.874 10.5128L12.8686 7.23833C13.0524 7.04551 13.0524 6.74232 12.8686 6.5495L12.4893 6.17015C12.2965 5.98633 11.9933 5.98633 11.8005 6.17015L8.52644 9.16505C7.92893 9.71711 7.05625 9.85139 6.32044 9.50447L1.32949 7.14848C1.13702 7.076 1.00706 6.89483 1.00009 6.68926V6.52953C0.982409 6.30492 1.11738 6.09631 1.32949 6.0204L18.0492 0.0306031C18.2289 -0.0354106 18.4306 0.00725579 18.5682 0.140416L18.8278 0.399974C18.9838 0.536262 19.0394 0.754748 18.9675 0.949039Z" fill="currentColor"/>\n              </svg>\n            </div>\n          </div>\n        </label>\n      </div>\n    </div>\n  </div>\n\n  <style type="text/css">').concat(c,"</style>\n\n</div>\n    ")}}]),e}()},function(e,t){e.exports={trackShow:function(e){mkz("trackSurveyFormShow",{survey_form_uid:e})},trackSubmit:function(e,t){mkz("trackSurveyFormSubmit",{survey_form_uid:e},null,t)}}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var i=n(0),r=n.n(i),o=n(1),s=n.n(o),a=function(){function e(t){var n=this;r()(this,e),this.audio=new Audio||document.createElement("video"),this.audio&&t&&(this.onload=!1,this.onplay=!1,this.audio.autoplay=!1,this.audio.load(),this.audio.canPlayType("audio/ogg")?this.audio.src=t+".ogg":this.audio.canPlayType("audio/mp3")&&(this.audio.src=t+".mp3"),this.audio.onloadeddata=function(){n.onload=!0,n.onplay&&n.playAction()})}return s()(e,[{key:"play",value:function(){this.audio&&(this.onload?this.playAction():this.onplay=!0)}},{key:"playAction",value:function(){this.audio.currentTime=0,this.audio.play().catch((function(e){}))}}]),e}()}]);